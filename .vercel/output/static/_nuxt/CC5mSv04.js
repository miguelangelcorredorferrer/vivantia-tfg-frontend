import{U,r as u,q as C,c as d,o as n,j as v,k as o,a as r,t as f,h as m,v as x,s as y,i as V,d as j,H as N,f as w}from"./Z3C1zjOC.js";import{u as M}from"./ZEFxkT7r.js";import{u as z}from"./DPZQ8nY_.js";import{U as h}from"./DnZbvBXp.js";import"./DTkYgPEM.js";import"./Dxmh1sec.js";const S={class:"space-y-8"},A={key:0,class:"flex items-center justify-center py-12"},B={key:1,class:"bg-red-500/20 border border-red-500/30 rounded-lg p-6"},T={class:"flex items-center"},D={class:"text-red-300 mt-1"},R={key:2,class:"bg-gray-800/50 border border-gray-700 rounded-lg p-6"},q={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},I={class:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-700"},P=["disabled"],H={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},W={__name:"[id]",setup(G){const g=U().params.id;M();const{toast:c}=z(),t=u({name:"",email:"",role:"visitante",verified:!1}),p=u(!1),i=u(!1),s=u(null);C(async()=>{await b()});const b=async()=>{try{p.value=!0,s.value=null;const e=(await h.getAllUsers()).data.find(a=>a.id===parseInt(g));if(!e)throw new Error("Usuario no encontrado");t.value={name:e.name||"",email:e.email||"",role:e.role||"visitante",verified:e.verified||!1},console.log("✅ Usuario cargado exitosamente")}catch(l){console.error("❌ Error cargando usuario:",l),s.value="Error al cargar el usuario",c.error("Error al cargar el usuario")}finally{p.value=!1}},k=async()=>{try{if(i.value=!0,s.value=null,!t.value.name||!t.value.email)throw new Error("Todos los campos obligatorios deben estar completos");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.value.email))throw new Error("El formato del email no es válido");const e={name:t.value.name,email:t.value.email,role:t.value.role,verified:t.value.verified};await h.update(g,e),c.success("Usuario actualizado exitosamente"),await w("/admin/usuarios")}catch(l){console.error("❌ Error actualizando usuario:",l),s.value=l.message||"Error al actualizar el usuario",c.error(s.value)}finally{i.value=!1}},E=()=>{w("/admin/usuarios")};return(l,e)=>(n(),d("div",S,[e[15]||(e[15]=v('<div class="mb-8"><div class="flex items-center space-x-3 mb-2"><div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-lg flex items-center justify-center"><svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></div><div><h1 class="text-3xl font-bold text-white">Panel de Administración</h1><p class="text-gray-400">Bienvenido al centro de control del sistema Vivantia</p></div></div><div class="mt-4"><h2 class="text-xl font-semibold text-white">Editar Usuario</h2><p class="text-gray-400 mt-1">Modificar información del usuario</p></div></div>',1)),o(p)?(n(),d("div",A,e[4]||(e[4]=[r("div",{class:"text-center"},[r("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500 mb-4"}),r("p",{class:"text-gray-400"},"Cargando usuario...")],-1)]))):o(s)?(n(),d("div",B,[r("div",T,[e[6]||(e[6]=r("svg",{class:"w-6 h-6 text-red-400 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),r("div",null,[e[5]||(e[5]=r("h3",{class:"text-lg font-medium text-red-400"},"Error",-1)),r("p",D,f(o(s)),1)])]),r("button",{onClick:b,class:"mt-4 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-md transition-colors"}," Reintentar ")])):(n(),d("div",R,[r("form",{onSubmit:N(k,["prevent"]),class:"space-y-6"},[r("div",q,[r("div",null,[e[7]||(e[7]=r("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Nombre Completo * ",-1)),m(r("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>o(t).name=a),type:"text",required:"",class:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ej: Juan Pérez"},null,512),[[x,o(t).name]])]),r("div",null,[e[8]||(e[8]=r("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Email * ",-1)),m(r("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>o(t).email=a),type:"email",required:"",class:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ej: juan.perez@email.com"},null,512),[[x,o(t).email]])]),r("div",null,[e[10]||(e[10]=r("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Rol * ",-1)),m(r("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>o(t).role=a),required:"",class:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"},e[9]||(e[9]=[r("option",{value:"visitante"},"Visitante",-1),r("option",{value:"usuario"},"Usuario",-1),r("option",{value:"admin"},"Administrador",-1)]),512),[[y,o(t).role]])]),r("div",null,[e[12]||(e[12]=r("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Estado de Verificación ",-1)),m(r("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>o(t).verified=a),class:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"},e[11]||(e[11]=[r("option",{value:!1},"No verificado",-1),r("option",{value:!0},"Verificado",-1)]),512),[[y,o(t).verified]]),e[13]||(e[13]=r("p",{class:"text-xs text-gray-500 mt-1"},"Controla si el usuario puede acceder al sistema",-1))])]),e[14]||(e[14]=v('<div class="bg-gray-700/30 rounded-lg p-4"><h3 class="text-lg font-medium text-white mb-4">Información No Editable</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label class="block text-sm font-medium text-gray-400 mb-2"> Contraseña </label><input value="••••••••" type="password" disabled class="w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded-md text-gray-400 cursor-not-allowed"><p class="text-xs text-gray-500 mt-1">Por seguridad, la contraseña no puede ser modificada</p></div><div><label class="block text-sm font-medium text-gray-400 mb-2"> Token de Autenticación </label><input value="No editable" type="text" disabled class="w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded-md text-gray-400 cursor-not-allowed"><p class="text-xs text-gray-500 mt-1">El token se genera automáticamente</p></div></div></div>',1)),r("div",I,[r("button",{type:"button",onClick:E,class:"px-6 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-md transition-colors"}," Cancelar "),r("button",{type:"submit",disabled:o(i),class:"px-6 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-purple-800 disabled:cursor-not-allowed text-white rounded-md transition-colors flex items-center"},[o(i)?(n(),d("div",H)):V("",!0),j(" "+f(o(i)?"Guardando...":"Guardar Cambios"),1)],8,P)])],32)]))]))}};export{W as default};
