import{u as Ae}from"./C0_HfsNw.js";import{u as ke}from"./6yrW6Ic0.js";import{u as Ie}from"./aBfGhltR.js";import{_ as X,r as F,l as j,q as G,n as $,y as Y,c as v,o as h,a as t,z as Z,i as Ne,d as J,p,A as L,m as W,B as Q,t as b,C as je,w as Be,b as y,k as c,j as U,u as Ee,D as C,f as Re}from"./Z3C1zjOC.js";import{u as Fe,s as We}from"./D6bpf8h9.js";import{g as Ue,t as ze,h as te}from"./DYYJ9xn1.js";import ee from"./BYzMsTBh.js";import{B as Oe}from"./B0aUQyeA.js";import"./DTkYgPEM.js";import"./Dxmh1sec.js";import"./DPZQ8nY_.js";const Pe={class:"improved-chart"},Ve={class:"chart-wrapper"},qe={__name:"WorkingTemperatureChart",props:{data:{type:Object,required:!0},temperatureMax:{type:Number,default:28}},setup(n){const a=n,i=F(null);let e=null;const m=async()=>{if(i.value)try{console.log("üî• Creating temperature chart...");const{Chart:s}=await Z(async()=>{const{Chart:r}=await import("./DO0dOiDN.js");return{Chart:r}},[],import.meta.url),l=i.value.getContext("2d");e&&e.destroy(),e=new s(l,{type:"line",data:{labels:[],datasets:[{label:"Temperatura (¬∞C)",data:[],borderColor:"#ef4444",backgroundColor:"transparent",borderWidth:3,tension:.6,fill:!1,pointBackgroundColor:"#ef4444",pointBorderColor:"#ffffff",pointBorderWidth:3,pointRadius:5,pointHoverRadius:8},{label:`Umbral M√°ximo (${a.temperatureMax}¬∞C)`,data:[],borderColor:"#fbbf24",backgroundColor:"transparent",borderWidth:3,borderDash:[10,5],pointRadius:0,fill:!1,tension:0}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!0,position:"top",labels:{color:"#9ca3af",font:{size:12,weight:"600"},usePointStyle:!0,padding:20}},tooltip:{enabled:!0,mode:"index",intersect:!1,backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"rgba(239, 68, 68, 0.5)",borderWidth:1,callbacks:{label:function(r){return r.datasetIndex===0?`üå°Ô∏è Temperatura: ${r.parsed.y.toFixed(1)}¬∞C`:`‚ö†Ô∏è Umbral m√°ximo: ${r.parsed.y}¬∞C`}}}},scales:{x:{title:{display:!0,text:"Tiempo",color:"#9ca3af",font:{size:12,weight:"600"}},ticks:{color:"#9ca3af",maxTicksLimit:6,font:{size:11}},grid:{color:"rgba(255, 255, 255, 0.08)"}},y:{title:{display:!0,text:"Temperatura (¬∞C)",color:"#ef4444",font:{size:12,weight:"600"}},ticks:{color:"#9ca3af",font:{size:11},callback:function(r){return r.toFixed(2)+"¬∞C"}},grid:{color:"rgba(255, 255, 255, 0.08)"}}},elements:{point:{radius:4,hoverRadius:4}},animation:!1}}),console.log("‚úÖ Temperature chart created successfully")}catch(s){console.error("‚ùå Error creating temperature chart:",s)}},u=()=>{var s,l;if(!(!e||!a.data))try{const r=a.data.labels||[],g=((l=(s=a.data.datasets)==null?void 0:s[0])==null?void 0:l.data)||[],k=r.map(()=>a.temperatureMax),S=[...g,a.temperatureMax],M=Math.min(...S),H=Math.max(...S),B=(H-M)*.1,_=Math.max(0,M-B),D=H+B;console.log("üìä Updating temperature chart:",{labels:r.length,temperatureData:g.length,latestTemperature:g[g.length-1],latestTime:r[r.length-1],temperatureMax:a.temperatureMax,yAxisRange:{min:_,max:D}}),e.data.labels=[...r],e.data.datasets[0].data=[...g],e.data.datasets[1].data=[...k],e.data.datasets[1].label=`Umbral M√°ximo (${a.temperatureMax}¬∞C)`,e.options.scales.y.min=_,e.options.scales.y.max=D,e.update("none")}catch(r){console.error("‚ùå Error updating temperature chart:",r)}};return j(()=>a.data,s=>{s&&s.labels&&s.datasets&&(console.log("üìä Temperature data changed, triggering update"),$(()=>{u()}))},{deep:!0,immediate:!1}),j(()=>a.temperatureMax,s=>{console.log("üå°Ô∏è Temperature threshold changed:",s),$(()=>{u()})},{immediate:!1}),G(async()=>{console.log("üéØ Temperature chart component mounted"),await $(),await m(),a.data&&a.data.labels&&a.data.labels.length>0&&u()}),Y(()=>{console.log("üéØ Temperature chart component unmounted"),e&&(e.destroy(),e=null)}),(s,l)=>(h(),v("div",Pe,[t("div",Ve,[t("canvas",{ref_key:"canvas",ref:i},null,512)])]))}},Le=X(qe,[["__scopeId","data-v-6ec53e96"]]),Ge={class:"improved-chart"},Ye={class:"chart-wrapper"},Je={__name:"WorkingHumidityChart",props:{data:{type:Object,required:!0},humidityMin:{type:Number,default:40},humidityMax:{type:Number,default:80}},setup(n){const a=n,i=F(null);let e=null;const m=async()=>{if(i.value)try{console.log("üíß Creating humidity chart...");const{Chart:s}=await Z(async()=>{const{Chart:r}=await import("./DO0dOiDN.js");return{Chart:r}},[],import.meta.url),l=i.value.getContext("2d");e&&e.destroy(),e=new s(l,{type:"line",data:{labels:[],datasets:[{label:"Humedad (%)",data:[],borderColor:"#3b82f6",backgroundColor:"transparent",borderWidth:3,tension:.6,fill:!1,pointBackgroundColor:"#3b82f6",pointBorderColor:"#ffffff",pointBorderWidth:3,pointRadius:5,pointHoverRadius:8},{label:`Umbral M√≠nimo (${a.humidityMin}%)`,data:[],borderColor:"#60a5fa",backgroundColor:"transparent",borderWidth:3,borderDash:[10,5],pointRadius:0,fill:!1,tension:0},{label:`Umbral M√°ximo (${a.humidityMax}%)`,data:[],borderColor:"#1d4ed8",backgroundColor:"transparent",borderWidth:3,borderDash:[10,5],pointRadius:0,fill:!1,tension:0}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!0,position:"top",labels:{color:"#9ca3af",font:{size:12,weight:"600"},usePointStyle:!0,padding:20}},tooltip:{enabled:!0,mode:"index",intersect:!1,backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"rgba(59, 130, 246, 0.5)",borderWidth:1,callbacks:{label:function(r){return r.datasetIndex===0?`üíß Humedad: ${r.parsed.y.toFixed(1)}%`:r.datasetIndex===1?`‚ö†Ô∏è Umbral m√≠nimo: ${r.parsed.y}%`:`‚ö†Ô∏è Umbral m√°ximo: ${r.parsed.y}%`}}}},scales:{x:{title:{display:!0,text:"Tiempo",color:"#9ca3af",font:{size:12,weight:"600"}},ticks:{color:"#9ca3af",maxTicksLimit:6,font:{size:11}},grid:{color:"rgba(255, 255, 255, 0.08)"}},y:{title:{display:!0,text:"Humedad (%)",color:"#3b82f6",font:{size:12,weight:"600"}},ticks:{color:"#9ca3af",font:{size:11},callback:function(r){return r.toFixed(2)+"%"}},grid:{color:"rgba(255, 255, 255, 0.08)"}}},elements:{point:{radius:4,hoverRadius:4}},animation:!1}}),console.log("‚úÖ Humidity chart created successfully")}catch(s){console.error("‚ùå Error creating humidity chart:",s)}},u=()=>{var s,l;if(!(!e||!a.data))try{const r=a.data.labels||[],g=((l=(s=a.data.datasets)==null?void 0:s[0])==null?void 0:l.data)||[],k=r.map(()=>a.humidityMin),S=r.map(()=>a.humidityMax),M=[...g,a.humidityMin,a.humidityMax],H=Math.min(...M),A=Math.max(...M),_=(A-H)*.1,D=Math.max(0,H-_),I=Math.min(100,A+_);console.log("üìä Updating humidity chart:",{labels:r.length,humidityData:g.length,latestHumidity:g[g.length-1],latestTime:r[r.length-1],humidityMin:a.humidityMin,humidityMax:a.humidityMax,yAxisRange:{min:D,max:I}}),e.data.labels=[...r],e.data.datasets[0].data=[...g],e.data.datasets[1].data=[...k],e.data.datasets[2].data=[...S],e.data.datasets[1].label=`Umbral M√≠nimo (${a.humidityMin}%)`,e.data.datasets[2].label=`Umbral M√°ximo (${a.humidityMax}%)`,e.options.scales.y.min=D,e.options.scales.y.max=I,e.update("none")}catch(r){console.error("‚ùå Error updating humidity chart:",r)}};return j(()=>a.data,s=>{s&&s.labels&&s.datasets&&(console.log("üìä Humidity data changed, triggering update"),$(()=>{u()}))},{deep:!0,immediate:!1}),j([()=>a.humidityMin,()=>a.humidityMax],([s,l])=>{console.log("üíß Humidity thresholds changed:",{min:s,max:l}),$(()=>{u()})},{immediate:!1}),G(async()=>{console.log("üéØ Humidity chart component mounted"),await $(),await m(),a.data&&a.data.labels&&a.data.labels.length>0&&u()}),Y(()=>{console.log("üéØ Humidity chart component unmounted"),e&&(e.destroy(),e=null)}),(s,l)=>(h(),v("div",Ge,[t("div",Ye,[t("canvas",{ref_key:"canvas",ref:i},null,512)])]))}},Ke=X(Je,[["__scopeId","data-v-52fdcc9f"]]),Qe={class:"improved-chart"},Xe={class:"chart-wrapper"},Ze={__name:"WorkingAirHumidityChart",props:{data:{type:Object,required:!0},airHumidityMin:{type:Number,default:30},airHumidityMax:{type:Number,default:85}},setup(n){const a=n,i=F(null);let e=null;const m=async()=>{if(i.value)try{console.log("üíß Creating air humidity chart...");const{Chart:s}=await Z(async()=>{const{Chart:r}=await import("./DO0dOiDN.js");return{Chart:r}},[],import.meta.url),l=i.value.getContext("2d");e&&e.destroy(),e=new s(l,{type:"line",data:{labels:[],datasets:[{label:"Humedad Ambiental (%)",data:[],borderColor:"#22d3ee",backgroundColor:"transparent",borderWidth:3,tension:.6,fill:!1,pointBackgroundColor:"#22d3ee",pointBorderColor:"#ffffff",pointBorderWidth:3,pointRadius:5,pointHoverRadius:8},{label:`Umbral M√≠nimo (${a.airHumidityMin}%)`,data:[],borderColor:"#06b6d4",backgroundColor:"transparent",borderWidth:3,borderDash:[10,5],pointRadius:0,fill:!1,tension:0},{label:`Umbral M√°ximo (${a.airHumidityMax}%)`,data:[],borderColor:"#0891b2",backgroundColor:"transparent",borderWidth:3,borderDash:[5,10],pointRadius:0,fill:!1,tension:0}]},options:{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"index"},plugins:{legend:{display:!0,position:"top",labels:{color:"#9ca3af",font:{size:12,weight:"600"},usePointStyle:!0,padding:20}},tooltip:{enabled:!0,mode:"index",intersect:!1,backgroundColor:"rgba(17, 24, 39, 0.9)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"rgba(34, 211, 238, 0.5)",borderWidth:1,callbacks:{label:function(r){return r.datasetIndex===0?`üí® Humedad Ambiental: ${r.parsed.y.toFixed(1)}%`:r.datasetIndex===1?`‚ö†Ô∏è Umbral m√≠nimo: ${r.parsed.y}%`:`‚ö†Ô∏è Umbral m√°ximo: ${r.parsed.y}%`}}}},scales:{x:{title:{display:!0,text:"Tiempo",color:"#9ca3af",font:{size:12,weight:"600"}},ticks:{color:"#9ca3af",maxTicksLimit:6,font:{size:11}},grid:{color:"rgba(255, 255, 255, 0.08)"}},y:{title:{display:!0,text:"Humedad Ambiental (%)",color:"#22d3ee",font:{size:12,weight:"600"}},ticks:{color:"#9ca3af",font:{size:11},callback:function(r){return r.toFixed(2)+"%"}},grid:{color:"rgba(255, 255, 255, 0.08)"}}},elements:{point:{radius:4,hoverRadius:4}},animation:!1}}),console.log("‚úÖ Air humidity chart created successfully")}catch(s){console.error("‚ùå Error creating air humidity chart:",s)}},u=()=>{var s,l;if(!(!e||!a.data))try{const r=a.data.labels||[],g=((l=(s=a.data.datasets)==null?void 0:s[0])==null?void 0:l.data)||[],k=r.map(()=>a.airHumidityMin),S=r.map(()=>a.airHumidityMax),M=[...g,a.airHumidityMin,a.airHumidityMax],H=Math.min(...M),A=Math.max(...M),_=(A-H)*.1,D=Math.max(0,H-_),I=Math.min(100,A+_);console.log("üìä Updating air humidity chart:",{labels:r.length,airHumidityData:g.length,latestAirHumidity:g[g.length-1],latestTime:r[r.length-1],airHumidityMin:a.airHumidityMin,airHumidityMax:a.airHumidityMax,yAxisRange:{min:D,max:I}}),e.data.labels=[...r],e.data.datasets[0].data=[...g],e.data.datasets[1].data=[...k],e.data.datasets[2].data=[...S],e.data.datasets[1].label=`Umbral M√≠nimo (${a.airHumidityMin}%)`,e.data.datasets[2].label=`Umbral M√°ximo (${a.airHumidityMax}%)`,e.options.scales.y.min=D,e.options.scales.y.max=I,e.update("none")}catch(r){console.error("‚ùå Error updating air humidity chart:",r)}};return j(()=>a.data,s=>{s&&s.labels&&s.datasets&&(console.log("üìä Air humidity data changed, triggering update"),$(()=>{u()}))},{deep:!0,immediate:!1}),j([()=>a.airHumidityMin,()=>a.airHumidityMax],([s,l])=>{console.log("üíß Air humidity thresholds changed:",{min:s,max:l}),$(()=>{u()})},{immediate:!1}),G(async()=>{console.log("üéØ Air humidity chart component mounted"),await $(),await m(),a.data&&a.data.labels&&a.data.labels.length>0&&u()}),Y(()=>{console.log("üéØ Air humidity chart component unmounted"),e&&(e.destroy(),e=null)}),(s,l)=>(h(),v("div",Qe,[t("div",Xe,[t("canvas",{ref_key:"canvas",ref:i},null,512)])]))}},et=X(Ze,[["__scopeId","data-v-9081e993"]]),tt={key:0,class:"bg-gradient-to-r from-orange-500/20 to-yellow-500/20 border border-orange-500/30 rounded-xl p-4 shadow-lg"},at={__name:"DemoBanner",props:{isDemoMode:{type:Boolean,default:!1}},emits:["exit-demo"],setup(n,{emit:a}){const i=a,e=()=>{i("exit-demo")};return(m,u)=>n.isDemoMode?(h(),v("div",tt,[t("div",{class:"flex items-center space-x-3"},[u[5]||(u[5]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"w-8 h-8 text-orange-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})])],-1)),t("div",{class:"flex-1"},[u[4]||(u[4]=t("h3",{class:"text-lg font-medium text-orange-300"},"üé≠ Modo Vista Previa",-1)),t("p",{class:"text-sm text-orange-200"},[u[0]||(u[0]=J(" Est√°s viendo una demostraci√≥n con datos simulados. ")),u[1]||(u[1]=t("span",{class:"font-medium"},"Las funcionalidades est√°n limitadas.",-1)),u[2]||(u[2]=J(" Para acceder a todas las caracter√≠sticas, ")),t("button",{onClick:e,class:"underline hover:text-white transition-colors"}," inicia sesi√≥n aqu√≠ "),u[3]||(u[3]=J(". "))])]),u[6]||(u[6]=t("div",{class:"flex items-center space-x-2"},[t("div",{class:"w-3 h-3 bg-orange-400 rounded-full animate-pulse"}),t("span",{class:"text-sm text-orange-300 font-medium"},"DEMO")],-1))])])):Ne("",!0)}},rt={class:"enhanced-sensor-card"},ot={class:"sensor-header"},it={class:"flex items-center space-x-3"},st={class:"text-xl font-bold text-white"},nt={class:"text-gray-400"},lt={class:"sensor-display"},dt={class:"trend-arrow"},ct={class:"trend-percent"},K={__name:"SensorCard",props:{title:{type:String,required:!0},description:{type:String,required:!0},icon:{type:Object,required:!0},iconBgClass:{type:String,required:!0},valueColorClass:{type:String,required:!0},formattedValue:{type:String,required:!0},trend:{type:Object,required:!0},chartComponent:{type:Object,required:!0},chartData:{type:Object,required:!0},chartProps:{type:Object,default:()=>({})}},setup(n){const a=n,i=p(()=>a.trend.direction==="up"?"trend-up":a.trend.direction==="down"?"trend-down":"trend-neutral"),e=p(()=>a.trend.direction==="up"?"‚Üó":a.trend.direction==="down"?"‚Üò":"‚Üí"),m=p(()=>a.trend.value);return(u,s)=>(h(),v("div",rt,[t("div",ot,[t("div",it,[t("div",{class:W(["sensor-icon",n.iconBgClass])},[(h(),L(Q(n.icon)))],2),t("div",null,[t("h3",st,b(n.title),1),t("p",nt,b(n.description),1)])]),t("div",lt,[t("div",{class:W(["main-value",n.valueColorClass])},b(n.formattedValue),3),t("div",{class:W(["trend-badge",i.value])},[t("span",dt,b(e.value),1),t("span",ct,b(m.value),1)],2)])]),(h(),L(Q(n.chartComponent),je({data:n.chartData},n.chartProps),null,16,["data"]))]))}},ut={class:"flex items-center space-x-3"},mt={class:"text-sm text-gray-400"},q={__name:"InfoCard",props:{iconName:{type:String,required:!0},iconBgClass:{type:String,required:!0},iconColorClass:{type:String,required:!0},label:{type:String,required:!0},value:{type:String,required:!0},valueColorClass:{type:String,required:!0}},setup(n){return(a,i)=>{const e=ee;return h(),L(Oe,{class:"info-card"},{default:Be(()=>[t("div",ut,[t("div",{class:W(["flex items-center justify-center w-10 h-10 rounded-lg",n.iconBgClass])},[y(e,{name:n.iconName,class:W(["w-5 h-5",n.iconColorClass])},null,8,["name","class"])],2),t("div",null,[t("p",mt,b(n.label),1),t("p",{class:W(["font-semibold",n.valueColorClass])},b(n.value),3)])])]),_:1})}}},pt={class:"space-y-4"},gt={class:"flex items-center space-x-3 mb-4"},ft={key:0,class:"space-y-3"},bt={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},yt={class:"text-white font-bold text-lg"},ht={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},xt={class:"text-green-400 font-bold text-lg"},vt={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},Ct={class:"text-blue-400 font-bold text-lg"},Mt={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},Ht={class:"text-blue-400 font-bold text-lg"},_t={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},Dt={class:"text-cyan-400 font-bold text-lg"},wt={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},Tt={class:"text-cyan-400 font-bold text-lg"},$t={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},St={class:"text-red-400 font-bold text-lg"},At={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},kt={class:"flex items-center space-x-2"},It={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},Nt={class:"text-white font-bold text-lg"},jt={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},Bt={class:"text-purple-400 font-bold text-lg"},Et={key:1,class:"space-y-3"},Rt={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"},Ft={class:"flex items-center space-x-2"},Wt={__name:"CropInfo",props:{currentCrop:{type:Object,default:null},hasSelectedCrop:{type:Boolean,default:!1}},setup(n){const a=Ue("plant");return(i,e)=>{const m=ee;return h(),v("div",pt,[t("div",gt,[(h(),L(Q(c(a)),{class:"w-6 h-6 text-green-400"})),e[0]||(e[0]=t("h4",{class:"text-lg font-bold text-white"},"Cultivo Seleccionado",-1))]),n.hasSelectedCrop?(h(),v("div",ft,[t("div",bt,[e[1]||(e[1]=t("span",{class:"text-gray-300 font-medium"},"Nombre:",-1)),t("span",yt,b(n.currentCrop.name),1)]),t("div",ht,[e[2]||(e[2]=t("span",{class:"text-gray-300 font-medium"},"Categor√≠a:",-1)),t("span",xt,b(n.currentCrop.category),1)]),t("div",vt,[e[3]||(e[3]=t("span",{class:"text-gray-300 font-medium"},"Hum. Suelo Min:",-1)),t("span",Ct,b(n.currentCrop.soil_humidity_min)+"%",1)]),t("div",Mt,[e[4]||(e[4]=t("span",{class:"text-gray-300 font-medium"},"Hum. Suelo Max:",-1)),t("span",Ht,b(n.currentCrop.soil_humidity_max)+"%",1)]),t("div",_t,[e[5]||(e[5]=t("span",{class:"text-gray-300 font-medium"},"Hum. Aire Min:",-1)),t("span",Dt,b(n.currentCrop.air_humidity_min)+"%",1)]),t("div",wt,[e[6]||(e[6]=t("span",{class:"text-gray-300 font-medium"},"Hum. Aire Max:",-1)),t("span",Tt,b(n.currentCrop.air_humidity_max)+"%",1)]),t("div",$t,[e[7]||(e[7]=t("span",{class:"text-gray-300 font-medium"},"Temperatura M√°xima:",-1)),t("span",St,b(n.currentCrop.temperature_max)+"¬∞C",1)]),t("div",At,[t("div",kt,[y(m,{name:"heroicons:beaker",class:"w-5 h-5 text-blue-400"}),e[8]||(e[8]=t("span",{class:"text-gray-300 font-medium"},"Estado de la Bomba:",-1))]),e[9]||(e[9]=t("div",{class:"flex items-center space-x-2"},[t("div",{class:"w-3 h-3 bg-blue-400 rounded-full animate-pulse"}),t("span",{class:"text-blue-400 font-bold text-lg"},"ACTIVA")],-1))]),t("div",It,[e[10]||(e[10]=t("span",{class:"text-gray-300 font-medium"},"D√≠as de Crecimiento:",-1)),t("span",Nt,b(n.currentCrop.growth_days)+" d√≠as",1)]),t("div",jt,[e[11]||(e[11]=t("span",{class:"text-gray-300 font-medium"},"Temporada:",-1)),t("span",Bt,b(n.currentCrop.session),1)])])):(h(),v("div",Et,[e[14]||(e[14]=U('<div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">Nombre:</span><span class="text-red-400 font-bold text-lg">No se ha seleccionado</span></div><div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">Categor√≠a:</span><span class="text-red-400 font-bold text-lg">No se ha seleccionado</span></div><div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">Hum. Suelo Min:</span><span class="text-red-400 font-bold text-lg">No disponible</span></div><div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">Hum. Suelo Max:</span><span class="text-red-400 font-bold text-lg">No disponible</span></div><div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">Hum. Aire Min:</span><span class="text-red-400 font-bold text-lg">No disponible</span></div><div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">Hum. Aire Max:</span><span class="text-red-400 font-bold text-lg">No disponible</span></div><div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">Temperatura M√°xima:</span><span class="text-red-400 font-bold text-lg">No disponible</span></div>',7)),t("div",Rt,[t("div",Ft,[y(m,{name:"heroicons:beaker",class:"w-5 h-5 text-red-400"}),e[12]||(e[12]=t("span",{class:"text-gray-300 font-medium"},"Estado de la Bomba:",-1))]),e[13]||(e[13]=t("div",{class:"flex items-center space-x-2"},[t("div",{class:"w-3 h-3 bg-red-400 rounded-full"}),t("span",{class:"text-red-400 font-bold text-lg"},"NO SELECCIONADO")],-1))]),e[15]||(e[15]=U('<div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">D√≠as de Crecimiento:</span><span class="text-red-400 font-bold text-lg">No disponible</span></div><div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">Temporada:</span><span class="text-red-400 font-bold text-lg">No disponible</span></div>',2))]))])}}},Ut={class:"space-y-4"},zt={class:"flex items-center space-x-3 mb-4"},Ot={key:0,class:"space-y-3"},Pt={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},Vt={class:"text-white font-bold text-lg"},qt={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},Lt={class:"text-gray-300 font-mono font-bold text-lg"},Gt={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"},Yt={class:"flex items-center space-x-2"},Jt={key:1,class:"space-y-3"},Kt={class:"flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"},Qt={class:"flex items-center space-x-2"},Xt={__name:"DeviceInfo",props:{currentDevice:{type:Object,default:null},hasActiveDevice:{type:Boolean,default:!1}},setup(n){return(a,i)=>{var m,u;const e=ee;return h(),v("div",Ut,[t("div",zt,[y(e,{name:"heroicons:cpu-chip",class:"w-6 h-6 text-blue-400"}),i[0]||(i[0]=t("h4",{class:"text-lg font-bold text-white"},"Dispositivo Registrado",-1))]),n.hasActiveDevice?(h(),v("div",Ot,[t("div",Pt,[i[1]||(i[1]=t("span",{class:"text-gray-300 font-medium"},"Nombre:",-1)),t("span",Vt,b((m=n.currentDevice)==null?void 0:m.deviceName),1)]),t("div",qt,[i[2]||(i[2]=t("span",{class:"text-gray-300 font-medium"},"ID del Dispositivo:",-1)),t("span",Lt,b((u=n.currentDevice)==null?void 0:u.enddeviceId),1)]),t("div",Gt,[t("div",Yt,[y(e,{name:"heroicons:wifi",class:"w-5 h-5 text-green-400"}),i[3]||(i[3]=t("span",{class:"text-gray-300 font-medium"},"Estado:",-1))]),i[4]||(i[4]=t("div",{class:"flex items-center space-x-2"},[t("div",{class:"w-3 h-3 rounded-full animate-pulse bg-green-400"}),t("span",{class:"font-bold text-lg text-green-400"},"CONECTADO")],-1))]),i[5]||(i[5]=U('<div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"><span class="text-gray-300 font-medium">Frecuencia de Datos:</span><span class="text-white font-bold text-lg">Cada 3 segundos</span></div><div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg hover:bg-gray-900/80 transition-colors"><span class="text-gray-300 font-medium">√öltima Comunicaci√≥n:</span><span class="text-green-400 font-bold text-lg">Ahora mismo</span></div>',2))])):(h(),v("div",Jt,[i[8]||(i[8]=U('<div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">Nombre:</span><span class="text-red-400 font-bold text-lg">No se ha registrado</span></div><div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">ID del Dispositivo:</span><span class="text-red-400 font-bold text-lg">No se ha registrado</span></div>',2)),t("div",Kt,[t("div",Qt,[y(e,{name:"heroicons:wifi",class:"w-5 h-5 text-red-400"}),i[6]||(i[6]=t("span",{class:"text-gray-300 font-medium"},"Estado:",-1))]),i[7]||(i[7]=t("div",{class:"flex items-center space-x-2"},[t("div",{class:"w-3 h-3 rounded-full bg-red-400"}),t("span",{class:"font-bold text-lg text-red-400"},"NO REGISTRADO")],-1))]),i[9]||(i[9]=U('<div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">Frecuencia de Datos:</span><span class="text-red-400 font-bold text-lg">No disponible</span></div><div class="flex justify-between items-center p-4 bg-gray-900/60 border border-gray-600/30 rounded-lg"><span class="text-gray-300 font-medium">√öltima Comunicaci√≥n:</span><span class="text-red-400 font-bold text-lg">No disponible</span></div>',2))]))])}}},Zt={class:"bg-gray-800/50 border border-blue-500/30 rounded-xl p-6 shadow-lg"},ea={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},ta={__name:"SystemInfoPanel",props:{currentCrop:{type:Object,default:null},hasSelectedCrop:{type:Boolean,default:!1},currentDevice:{type:Object,default:null},hasActiveDevice:{type:Boolean,default:!1}},setup(n){return(a,i)=>(h(),v("div",Zt,[i[0]||(i[0]=U('<div class="mb-6 border-b border-gray-600/50 pb-4"><div class="flex items-center space-x-3"><div class="w-3 h-3 bg-blue-400 rounded-full animate-pulse"></div><h3 class="text-2xl font-bold text-white">Informaci√≥n del Sistema</h3></div><p class="text-gray-400 mt-2">Detalles del cultivo activo y dispositivo IoT en funcionamiento</p></div>',1)),t("div",ea,[y(Wt,{"current-crop":n.currentCrop,"has-selected-crop":n.hasSelectedCrop},null,8,["current-crop","has-selected-crop"]),y(Xt,{"current-device":n.currentDevice,"has-active-device":n.hasActiveDevice},null,8,["current-device","has-active-device"])])]))}},aa={class:"dashboard-container space-y-8"},ra={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},oa={class:"mt-8"},ia={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6"},sa=20,ha={__name:"dashboard",setup(n){const a=ke(),i=Ie(),e=Ee(),m=Fe(),u=F(null),s=F(null),l=F([]),r=()=>{const o=new Date,d=o.toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit"});let x=19.5,f=68.3,w=75;if(l.value.length>0){const T=l.value[l.value.length-1];x=T.temperature,f=T.soilHumidity,w=T.airHumidity}const E=(Math.random()-.5)*.8,P=(Math.random()-.5)*1.2,V=(Math.random()-.5)*1.5,_e=Math.max(18,Math.min(22,x+E)),De=Math.max(65,Math.min(72,f+P)),we=Math.max(70,Math.min(80,w+V)),z={time:d,temperature:parseFloat(_e.toFixed(1)),soilHumidity:parseFloat(De.toFixed(1)),airHumidity:parseFloat(we.toFixed(1))};if(l.value.push(z),l.value.length>sa&&l.value.shift(),u.value={temperature:z.temperature,soilHumidity:z.soilHumidity,airHumidity:z.airHumidity,timestamp:o.toISOString()},console.log("üé≠ Demo data point added:",z),l.value.length>=2){const T=l.value[l.value.length-1],R=l.value[l.value.length-2],Te=T.temperature-R.temperature,$e=T.soilHumidity-R.soilHumidity,Se=T.airHumidity-R.airHumidity;console.log("üìä Demo trends calculation:",{temperature:`${R.temperature} ‚Üí ${T.temperature} (change: ${Te.toFixed(1)}¬∞C)`,soilHumidity:`${R.soilHumidity} ‚Üí ${T.soilHumidity} (change: ${$e.toFixed(1)}%)`,airHumidity:`${R.airHumidity} ‚Üí ${T.airHumidity} (change: ${Se.toFixed(1)}%)`})}},g=()=>{if(e.isDemoMode){console.log("üé≠ Starting demo simulation...");for(let o=0;o<5;o++)setTimeout(()=>{r()},o*300);s.value=We(()=>{r()},3e3)}},k=()=>{s.value&&(clearInterval(s.value),s.value=null)},S=Ae(),{temperatureData:M,soilHumidityData:H,airHumidityData:A,currentTemperature:B,currentSoilHumidity:_,currentAirHumidity:D,temperatureTrend:I,soilHumidityTrend:ae,airHumidityTrend:re,cropThresholds:oe,formattedTemperature:ie,formattedSoilHumidity:se,formattedAirHumidity:ne}=S,le=p(()=>{if(e.isDemoMode){const o=l.value;return{labels:o.map(d=>d.time),datasets:[{label:"Temperatura (¬∞C)",data:o.map(d=>d.temperature),borderColor:"#ef4444",backgroundColor:"transparent",borderWidth:3,tension:.6,fill:!1,pointBackgroundColor:"#ef4444",pointBorderColor:"#ffffff",pointBorderWidth:3,pointRadius:5,pointHoverRadius:8}]}}return M.value}),de=p(()=>{if(e.isDemoMode){const o=l.value;return{labels:o.map(d=>d.time),datasets:[{label:"Humedad del Suelo (%)",data:o.map(d=>d.soilHumidity),borderColor:"#3b82f6",backgroundColor:"transparent",borderWidth:3,tension:.6,fill:!1,pointBackgroundColor:"#3b82f6",pointBorderColor:"#ffffff",pointBorderWidth:3,pointRadius:5,pointHoverRadius:8}]}}return H.value}),ce=p(()=>{if(e.isDemoMode){const o=l.value;return{labels:o.map(d=>d.time),datasets:[{label:"Humedad Ambiental (%)",data:o.map(d=>d.airHumidity),borderColor:"#22d3ee",backgroundColor:"transparent",borderWidth:3,tension:.6,fill:!1,pointBackgroundColor:"#22d3ee",pointBorderColor:"#ffffff",pointBorderWidth:3,pointRadius:5,pointHoverRadius:8}]}}return A.value}),ue=p(()=>{var o,d;return e.isDemoMode?((o=u.value)==null?void 0:o.temperature)||((d=l.value[l.value.length-1])==null?void 0:d.temperature)||C.sensorData.current.temperature:B.value}),me=p(()=>{var o,d;return e.isDemoMode?((o=u.value)==null?void 0:o.soilHumidity)||((d=l.value[l.value.length-1])==null?void 0:d.soilHumidity)||C.sensorData.current.soilHumidity:_.value}),pe=p(()=>{var o,d;return e.isDemoMode?((o=u.value)==null?void 0:o.airHumidity)||((d=l.value[l.value.length-1])==null?void 0:d.airHumidity)||75:D.value}),ge=p(()=>{if(e.isDemoMode){const o=l.value;if(o.length>=2){const d=o[o.length-1].temperature,x=o[o.length-2].temperature,f=d-x;return Math.abs(f)>=.1?{direction:f>0?"up":"down",value:Math.abs(f).toFixed(1)}:{direction:"neutral",value:"0.0"}}return{direction:"neutral",value:"0.0"}}return I.value}),fe=p(()=>{if(e.isDemoMode){const o=l.value;if(o.length>=2){const d=o[o.length-1].soilHumidity,x=o[o.length-2].soilHumidity,f=d-x;return Math.abs(f)>=.5?{direction:f>0?"up":"down",value:Math.abs(f).toFixed(1)}:{direction:"neutral",value:"0.0"}}return{direction:"neutral",value:"0.0"}}return ae.value}),be=p(()=>{if(e.isDemoMode){const o=l.value;if(o.length>=2){const d=o[o.length-1].airHumidity,x=o[o.length-2].airHumidity,f=d-x;return Math.abs(f)>=.5?{direction:f>0?"up":"down",value:Math.abs(f).toFixed(1)}:{direction:"neutral",value:"0.0"}}return{direction:"neutral",value:"0.0"}}return re.value});p(()=>e.isDemoMode?{soilHumidityMin:C.crop.soil_humidity_min,soilHumidityMax:C.crop.soil_humidity_max,airHumidityMin:C.crop.air_humidity_min,airHumidityMax:C.crop.air_humidity_max,temperatureMax:C.crop.temperature_max}:oe.value);const ye=p(()=>e.isDemoMode?`${ue.value.toFixed(1)}¬∞C`:ie.value),he=p(()=>e.isDemoMode?`${me.value.toFixed(1)}%`:se.value),xe=p(()=>e.isDemoMode?`${pe.value.toFixed(1)}%`:ne.value),O=p(()=>e.isDemoMode?{status:"Inactiva",iconBg:"bg-gray-500/20",iconColor:"text-gray-400",valueColor:"text-gray-400"}:m.isWatering?{status:m.isPaused?"Pausada":"Activa",iconBg:m.isPaused?"bg-yellow-500/20":"bg-green-500/20",iconColor:m.isPaused?"text-yellow-400":"text-green-400",valueColor:m.isPaused?"text-yellow-400":"text-green-400"}:{status:"Inactiva",iconBg:"bg-gray-500/20",iconColor:"text-gray-400",valueColor:"text-gray-400"}),ve=p(()=>e.isDemoMode?C.device:i.activeDevices.length>0?i.activeDevices[0]:null),N=p(()=>e.isDemoMode?C.crop:a.crops.find(d=>d.selected)||null),Ce=p(()=>e.isDemoMode?!0:i.activeDevices.length>0),Me=p(()=>e.isDemoMode?!0:a.crops.some(o=>o.selected));G(async()=>{var o;try{if(e.isDemoMode){console.log("üé≠ Dashboard: Iniciando modo demo"),u.value={temperature:C.sensorData.current.temperature,soilHumidity:C.sensorData.current.soilHumidity,airHumidity:C.sensorData.current.airHumidity,timestamp:new Date().toISOString()};for(let d=0;d<5;d++){const x=new Date(Date.now()-(4-d)*3e3).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),f=19.5+(Math.random()-.5)*2,w=68.3+(Math.random()-.5)*3,E=75+(Math.random()-.5)*4;l.value.push({time:x,temperature:parseFloat(f.toFixed(1)),soilHumidity:parseFloat(w.toFixed(1)),airHumidity:parseFloat(E.toFixed(1))})}g()}else if(console.log("üìä Dashboard: Cargando datos reales"),(o=e.user)!=null&&o.id){a.crops.length===0&&(console.log("üå± Cargando cultivos del usuario..."),await a.fetchAllUserCrops(e.user.id)),i.devices.length===0&&(console.log("üì± Cargando dispositivos del usuario..."),await i.fetchUserDevice(e.user.id)),console.log("‚úÖ Datos del dashboard cargados - Cultivos:",a.crops.length,"Dispositivos:",i.devices.length);try{await m.loadActiveConfiguration(),console.log("‚úÖ Configuraci√≥n de riego cargada - Estado bomba:",m.isWatering)}catch{console.log("‚ÑπÔ∏è No hay configuraci√≥n de riego activa")}}}catch(d){console.error("Error cargando datos del dashboard:",d)}}),j(()=>a.crops,o=>{if(!e.isDemoMode){console.log("üîÑ Dashboard: Array de cultivos actualizado, cultivos:",o.length);const d=o.find(x=>x.selected);d&&console.log("‚úÖ Dashboard: Cultivo seleccionado detectado:",d.name)}},{deep:!0}),Y(()=>{k()});const He=()=>{e.exitDemoMode(),Re("/auth/login")};return(o,d)=>{var x,f,w,E,P,V;return h(),v("div",aa,[y(c(at),{"is-demo-mode":c(e).isDemoMode,onExitDemo:He},null,8,["is-demo-mode"]),d[0]||(d[0]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h1",{class:"text-4xl font-bold text-white mb-2"},"Dashboard de Sensores IoT"),t("p",{class:"text-gray-400 text-lg"},"Monitoreo en tiempo real de temperatura y humedad para sistemas de riego automatizado")])],-1)),t("div",ra,[y(c(K),{title:"Temperatura Ambiental",description:"Sensor DHT11 - Actualizaci√≥n cada 2 minutos",icon:c(ze),"icon-bg-class":"bg-gradient-to-br from-red-500 to-red-600","value-color-class":"text-red-400","formatted-value":c(ye),trend:c(ge),"chart-component":Le,"chart-data":c(le),"chart-props":{temperatureMax:((x=c(N))==null?void 0:x.temperature_max)||28}},null,8,["icon","formatted-value","trend","chart-data","chart-props"]),y(c(K),{title:"Humedad del Suelo",description:"Sensor Capacitive Soil Moisture - Actualizaci√≥n cada 2 minutos",icon:c(te),"icon-bg-class":"bg-gradient-to-br from-blue-500 to-blue-600","value-color-class":"text-blue-400","formatted-value":c(he),trend:c(fe),"chart-component":Ke,"chart-data":c(de),"chart-props":{humidityMin:((f=c(N))==null?void 0:f.soil_humidity_min)||40,humidityMax:((w=c(N))==null?void 0:w.soil_humidity_max)||80}},null,8,["icon","formatted-value","trend","chart-data","chart-props"])]),t("div",oa,[y(c(K),{title:"Humedad Ambiental",description:"Sensor DHT11 - Actualizaci√≥n cada 2 minutos",icon:c(te),"icon-bg-class":"bg-gradient-to-br from-cyan-500 to-cyan-600","value-color-class":"text-cyan-400","formatted-value":c(xe),trend:c(be),"chart-component":et,"chart-data":c(ce),"chart-props":{airHumidityMin:((E=c(N))==null?void 0:E.air_humidity_min)||30,airHumidityMax:((P=c(N))==null?void 0:P.air_humidity_max)||85}},null,8,["icon","formatted-value","trend","chart-data","chart-props"])]),t("div",ia,[y(c(q),{"icon-name":"heroicons:clock","icon-bg-class":"bg-blue-500/20","icon-color-class":"text-blue-400",label:"√öltima actualizaci√≥n",value:new Date().toLocaleTimeString("es-ES"),"value-color-class":"text-white"},null,8,["value"]),y(c(q),{"icon-name":"heroicons:signal","icon-bg-class":"bg-green-500/20","icon-color-class":"text-green-400",label:"Estado TTN",value:"Conectado","value-color-class":"text-green-400"}),y(c(q),{"icon-name":"heroicons:cog-6-tooth","icon-bg-class":"bg-purple-500/20","icon-color-class":"text-purple-400",label:"Cultivo actual",value:((V=c(N))==null?void 0:V.name)||"-","value-color-class":"text-white"},null,8,["value"]),y(c(q),{"icon-name":"heroicons:beaker","icon-bg-class":c(O).iconBg,"icon-color-class":c(O).iconColor,label:"Bomba de riego",value:c(O).status,"value-color-class":c(O).valueColor},null,8,["icon-bg-class","icon-color-class","value","value-color-class"])]),y(c(ta),{"current-crop":c(N),"has-selected-crop":c(Me),"current-device":c(ve),"has-active-device":c(Ce)},null,8,["current-crop","has-selected-crop","current-device","has-active-device"])])}}};export{ha as default};
