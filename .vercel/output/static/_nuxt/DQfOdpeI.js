const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Dxmh1sec.js","./Z3C1zjOC.js","./entry.CDCMNb7-.css"])))=>i.map(i=>d[i]);
import{_ as O,u as H,r as E,g as P,A as le,o as n,w as j,a as e,H as V,h as w,v as C,d as M,s as G,c as a,i as S,m as $,t as I,p as J,l as z,F as R,x as F,b as K,z as L,j as q,q as ne,k as ae}from"./Z3C1zjOC.js";import{u as Q}from"./aBfGhltR.js";import{u as U}from"./DPZQ8nY_.js";import{B as W}from"./B0aUQyeA.js";import{E as de}from"./CA0rq46Z.js";import{C as ce}from"./Bd8gKvt7.js";import{_ as ue}from"./DFmUCHXo.js";import"./Dxmh1sec.js";const pe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ve={class:"border-t border-gray-600 pt-6"},me={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},ge={class:"flex justify-end"},fe=["disabled"],ye={key:0,class:"flex items-center"},xe={key:1,class:"flex items-center"},be={__name:"DeviceForm",emits:["device-added"],setup(y,{emit:D}){const m=D;Q(),H();const{deviceAdded:b,deviceAddError:v}=U(),s=E(!1),i=P({deviceName:"",enddeviceId:"",appEui:"",devEui:"",appKey:"",ttnRegion:"",ttnAppId:"",ttnAccessKey:""}),N=async()=>{s.value=!0;try{m("device-added",{...i}),b(i.deviceName),Object.keys(i).forEach(x=>{i[x]=""})}catch(x){console.error("Error al agregar dispositivo:",x),v()}finally{s.value=!1}};return(x,o)=>(n(),le(W,{title:"Registrar Nuevo Dispositivo"},{default:j(()=>[e("form",{onSubmit:V(N,["prevent"]),class:"space-y-6","data-device-form":""},[e("div",pe,[e("div",null,[o[8]||(o[8]=e("label",{for:"deviceName",class:"block text-sm font-medium text-white mb-2"}," Device Name ",-1)),w(e("input",{id:"deviceName","onUpdate:modelValue":o[0]||(o[0]=t=>i.deviceName=t),type:"text",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Ej: Sensor Riego 01"},null,512),[[C,i.deviceName]])]),e("div",null,[o[9]||(o[9]=e("label",{for:"enddeviceId",class:"block text-sm font-medium text-white mb-2"}," EnddeviceID ",-1)),w(e("input",{id:"enddeviceId","onUpdate:modelValue":o[1]||(o[1]=t=>i.enddeviceId=t),type:"text",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Ej: my-device-01"},null,512),[[C,i.enddeviceId]])]),e("div",null,[o[10]||(o[10]=e("label",{for:"appEui",class:"block text-sm font-medium text-white mb-2"}," AppEUI ",-1)),w(e("input",{id:"appEui","onUpdate:modelValue":o[2]||(o[2]=t=>i.appEui=t),type:"text",required:"",pattern:"[A-Fa-f0-9]{16}",maxlength:"16",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors font-mono",placeholder:"0123456789ABCDEF"},null,512),[[C,i.appEui]]),o[11]||(o[11]=e("p",{class:"mt-1 text-xs text-gray-400"},"16 caracteres hexadecimales",-1))]),e("div",null,[o[12]||(o[12]=e("label",{for:"devEui",class:"block text-sm font-medium text-white mb-2"}," DevEUI ",-1)),w(e("input",{id:"devEui","onUpdate:modelValue":o[3]||(o[3]=t=>i.devEui=t),type:"text",required:"",pattern:"[A-Fa-f0-9]{16}",maxlength:"16",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors font-mono",placeholder:"FEDCBA9876543210"},null,512),[[C,i.devEui]]),o[13]||(o[13]=e("p",{class:"mt-1 text-xs text-gray-400"},"16 caracteres hexadecimales",-1))])]),e("div",null,[o[14]||(o[14]=e("label",{for:"appKey",class:"block text-sm font-medium text-white mb-2"}," AppKey ",-1)),w(e("input",{id:"appKey","onUpdate:modelValue":o[4]||(o[4]=t=>i.appKey=t),type:"text",required:"",pattern:"[A-Fa-f0-9]{32}",maxlength:"32",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors font-mono",placeholder:"0123456789ABCDEF0123456789ABCDEF"},null,512),[[C,i.appKey]]),o[15]||(o[15]=e("p",{class:"mt-1 text-xs text-gray-400"},"32 caracteres hexadecimales",-1))]),e("div",ve,[o[23]||(o[23]=e("h3",{class:"text-lg font-medium text-white mb-4 flex items-center"},[e("svg",{class:"w-5 h-5 mr-2 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})]),M(" Configuraci√≥n TTN (The Things Network) ")],-1)),e("div",me,[e("div",null,[o[17]||(o[17]=e("label",{for:"ttnRegion",class:"block text-sm font-medium text-white mb-2"}," TTN Region ",-1)),w(e("select",{id:"ttnRegion","onUpdate:modelValue":o[5]||(o[5]=t=>i.ttnRegion=t),class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"},o[16]||(o[16]=[e("option",{value:""},"Seleccionar regi√≥n",-1),e("option",{value:"eu1"},"Europe 1 (eu1)",-1),e("option",{value:"nam1"},"North America 1 (nam1)",-1),e("option",{value:"au1"},"Australia 1 (au1)",-1),e("option",{value:"as1"},"Asia 1 (as1)",-1)]),512),[[G,i.ttnRegion]]),o[18]||(o[18]=e("p",{class:"mt-1 text-xs text-gray-400"},"Regi√≥n del servidor TTN",-1))]),e("div",null,[o[19]||(o[19]=e("label",{for:"ttnAppId",class:"block text-sm font-medium text-white mb-2"}," TTN Application ID ",-1)),w(e("input",{id:"ttnAppId","onUpdate:modelValue":o[6]||(o[6]=t=>i.ttnAppId=t),type:"text",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"my-ttn-application"},null,512),[[C,i.ttnAppId]]),o[20]||(o[20]=e("p",{class:"mt-1 text-xs text-gray-400"},"ID de la aplicaci√≥n en TTN",-1))]),e("div",null,[o[21]||(o[21]=e("label",{for:"ttnAccessKey",class:"block text-sm font-medium text-white mb-2"}," TTN Access Key ",-1)),w(e("input",{id:"ttnAccessKey","onUpdate:modelValue":o[7]||(o[7]=t=>i.ttnAccessKey=t),type:"password",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors font-mono",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"},null,512),[[C,i.ttnAccessKey]]),o[22]||(o[22]=e("p",{class:"mt-1 text-xs text-gray-400"},"Clave de acceso para la API TTN",-1))])]),o[24]||(o[24]=e("div",{class:"mt-4 p-3 bg-blue-900/20 border border-blue-500/30 rounded-lg"},[e("div",{class:"flex items-start"},[e("svg",{class:"w-5 h-5 text-blue-400 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("div",{class:"text-sm text-blue-300"},[e("p",{class:"font-medium mb-1"},"Configuraci√≥n TTN (Opcional)"),e("p",null,"Los campos TTN son necesarios para el control remoto de la bomba de riego. Puedes configurarlos ahora o m√°s tarde desde la edici√≥n del dispositivo.")])])],-1))]),e("div",ge,[e("button",{type:"submit",disabled:s.value,class:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-semibold rounded-lg shadow-lg hover:from-blue-600 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105"},[s.value?(n(),a("span",ye,o[25]||(o[25]=[e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),M(" Agregando... ")]))):(n(),a("span",xe,o[26]||(o[26]=[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),M(" Add Device ")])))],8,fe)])],32)]),_:1}))}},he=O(be,[["__scopeId","data-v-b8ed5c74"]]),we={class:"inline-flex items-center"},ke={__name:"DatabaseStatusIcon",props:{isActive:{type:Boolean,default:!1},showStatusDot:{type:Boolean,default:!1},showStatusText:{type:Boolean,default:!1}},setup(y){return(D,m)=>(n(),a("div",we,[e("div",{class:$(["p-2 rounded-full transition-colors duration-200",y.isActive?"bg-green-100":"bg-red-100"])},[(n(),a("svg",{class:$(["w-5 h-5 transition-colors duration-200",y.isActive?"text-green-600":"text-red-600"]),fill:"currentColor",viewBox:"0 0 20 20"},m[0]||(m[0]=[e("path",{d:"M3 12v3c0 1.657 3.134 3 7 3s7-1.343 7-3v-3c0 1.657-3.134 3-7 3s-7-1.343-7-3z"},null,-1),e("path",{d:"M3 7v3c0 1.657 3.134 3 7 3s7-1.343 7-3V7c0 1.657-3.134 3-7 3S3 8.657 3 7z"},null,-1),e("path",{d:"M17 5c0 1.657-3.134 3-7 3S3 6.657 3 5s3.134-3 7-3 7 1.343 7 3z"},null,-1)]),2))],2),y.showStatusDot?(n(),a("div",{key:0,class:$(["w-3 h-3 rounded-full ml-2 transition-colors duration-200",y.isActive?"bg-green-500":"bg-red-500"])},null,2)):S("",!0),y.showStatusText?(n(),a("span",{key:1,class:$(["ml-2 text-sm font-medium transition-colors duration-200",y.isActive?"text-green-600":"text-red-600"])},I(y.isActive?"Activo":"Inactivo"),3)):S("",!0)]))}},Ae={class:"bg-gray-800/50 border border-gray-600 rounded-lg p-4 mb-6"},Ee={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ce={class:"relative"},Ne={class:"relative"},Te={key:0,class:"absolute z-10 w-full mt-1 bg-gray-700 border border-gray-600 rounded-md shadow-lg max-h-40 overflow-y-auto"},Ie=["onMousedown"],De={class:"relative"},_e={class:"relative"},Ke={key:0,class:"absolute z-10 w-full mt-1 bg-gray-700 border border-gray-600 rounded-md shadow-lg max-h-40 overflow-y-auto"},Me=["onMousedown"],$e={class:"mt-4 flex justify-end"},Se=["disabled"],Be={__name:"DevicesFilter",props:{deviceStore:{type:Object,required:!0}},emits:["filter-change"],setup(y,{emit:D}){const m=y,b=D,v=E({deviceName:"",enddeviceId:""}),s=E(!1),i=E(!1),N=E([]),x=E([]),o=J(()=>v.value.deviceName.trim()!==""||v.value.enddeviceId.trim()!==""),t=()=>{const h=m.deviceStore.filterDevicesSuggestions(v.value.deviceName,"deviceName");N.value=h,s.value=h.length>0},c=()=>{const h=m.deviceStore.filterDevicesSuggestions(v.value.enddeviceId,"enddeviceId");x.value=h,i.value=h.length>0},p=(h,g)=>{v.value[h]=g,h==="deviceName"?(s.value=!1,N.value=[]):(i.value=!1,x.value=[])},f=h=>{setTimeout(()=>{h==="deviceName"?s.value=!1:i.value=!1},200)},k=()=>{v.value={deviceName:"",enddeviceId:""}};return z(v,h=>{b("filter-change",{...h})},{deep:!0}),(h,g)=>(n(),a("div",Ae,[g[8]||(g[8]=e("h3",{class:"text-lg font-medium text-white mb-4"},"Filtrar Dispositivos",-1)),e("div",Ee,[e("div",Ce,[g[6]||(g[6]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," Nombre del Dispositivo ",-1)),e("div",Ne,[w(e("input",{"onUpdate:modelValue":g[0]||(g[0]=A=>v.value.deviceName=A),onInput:t,onFocus:g[1]||(g[1]=A=>s.value=!0),onBlur:g[2]||(g[2]=A=>f("deviceName")),type:"text",placeholder:"Buscar por nombre...",class:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,544),[[C,v.value.deviceName]]),s.value&&N.value.length>0?(n(),a("div",Te,[(n(!0),a(R,null,F(N.value,A=>(n(),a("button",{key:A,onMousedown:B=>p("deviceName",A),class:"w-full px-3 py-2 text-left text-white hover:bg-gray-600 focus:bg-gray-600 focus:outline-none"},I(A),41,Ie))),128))])):S("",!0)])]),e("div",De,[g[7]||(g[7]=e("label",{class:"block text-sm font-medium text-gray-300 mb-2"}," EndDevice ID ",-1)),e("div",_e,[w(e("input",{"onUpdate:modelValue":g[3]||(g[3]=A=>v.value.enddeviceId=A),onInput:c,onFocus:g[4]||(g[4]=A=>i.value=!0),onBlur:g[5]||(g[5]=A=>f("enddeviceId")),type:"text",placeholder:"Buscar por EndDevice ID...",class:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"},null,544),[[C,v.value.enddeviceId]]),i.value&&x.value.length>0?(n(),a("div",Ke,[(n(!0),a(R,null,F(x.value,A=>(n(),a("button",{key:A,onMousedown:B=>p("enddeviceId",A),class:"w-full px-3 py-2 text-left text-white hover:bg-gray-600 focus:bg-gray-600 focus:outline-none"},I(A),41,Me))),128))])):S("",!0)])])]),e("div",$e,[e("button",{onClick:k,disabled:!o.value,class:"px-4 py-2 text-sm font-medium text-gray-300 hover:text-white disabled:text-gray-500 disabled:cursor-not-allowed transition-colors"}," Limpiar filtros ",8,Se)])]))}},je={class:"flex items-center space-x-4"},Ve={class:"flex items-center space-x-2"},ze={class:"text-sm text-gray-300 font-bold"},Re={key:0,class:"text-center py-12"},Fe={class:"text-lg font-medium text-white mb-2"},Ue={class:"text-gray-400"},Le={key:0,class:"mt-6"},qe={key:1,class:"overflow-x-auto"},Oe={class:"w-full text-sm text-left min-w-[1200px]"},He={class:"divide-y divide-gray-600"},Pe={class:"px-4 py-4 font-medium text-white text-center"},Ge={class:"flex items-center justify-center"},Je={class:"px-4 py-4 text-gray-300 font-mono text-sm text-center"},Qe={class:"px-4 py-4 text-gray-300 font-mono text-sm text-center"},We={class:"bg-gray-700 px-2 py-1 rounded text-xs"},Xe={class:"px-4 py-4 text-gray-300 font-mono text-sm text-center"},Ye={class:"bg-gray-700 px-2 py-1 rounded text-xs"},Ze={class:"px-4 py-4 text-gray-300 font-mono text-sm text-center"},et={class:"flex items-center justify-center space-x-2"},tt={class:"relative bg-gray-700 rounded text-xs overflow-hidden",style:{width:"120px"}},ot=["type","value","placeholder"],st={class:"flex items-center space-x-1"},rt=["onClick","title"],it={key:0,class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},lt={key:1,class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},nt=["onClick","title"],at={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},dt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ct={class:"px-4 py-4 text-gray-300 text-sm text-center"},ut={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-900/30 text-blue-400 border border-blue-500/30"},pt={key:1,class:"text-gray-500 italic"},vt={class:"px-4 py-4 text-gray-300 font-mono text-sm text-center"},mt={key:0,class:"max-w-32 truncate"},gt={key:1,class:"text-gray-500 italic"},ft={class:"px-4 py-4 text-gray-300 font-mono text-sm text-center"},yt={key:0,class:"flex items-center justify-center space-x-2"},xt={class:"relative bg-gray-700 rounded text-xs overflow-hidden",style:{width:"120px"}},bt=["type","value","placeholder"],ht={class:"flex items-center space-x-1"},wt=["onClick","title"],kt={key:0,class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},At={key:1,class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Et=["onClick","title"],Ct={key:0,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Nt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Tt={key:1,class:"text-gray-500 italic"},It={class:"px-4 py-4"},Dt={class:"flex items-center justify-center space-x-3"},_t={class:"px-4 py-4"},Kt={class:"flex items-center justify-center space-x-4"},Mt={class:"flex flex-col items-center space-y-1"},$t=["onClick","title"],St={class:"flex flex-col items-center space-y-1"},Bt=["onClick","title"],jt={__name:"DevicesTable",props:{deviceStore:{type:Object,required:!0}},emits:["toggle-device","edit-device","delete-device"],setup(y,{emit:D}){const m=y,b=D,{deviceActivated:v,deviceDeactivated:s,appKeyCopied:i,appKeyCopyError:N}=U(),x=E({}),o=E({}),t=E({}),c=E({}),p=E({deviceName:"",enddeviceId:""}),f=E(!1),k=E(null),h=J(()=>{const d=m.deviceStore.filterDevices(p.value);return console.log("üîç Dispositivos filtrados en tabla:",d),d}),g=(d,r=!1)=>d?r&&d.length>16?`${d.substring(0,8)}...`:d.replace(/(.{4})/g,"$1 ").trim():"",A=d=>{p.value={...d}},B=async(d,r)=>{try{await m.deviceStore.toggleDeviceActive(d.id,r),r?m.deviceStore.devices.filter(l=>l.id!==d.id&&l.is_active_communication).length>0?v(`${d.deviceName} activado. Los dem√°s dispositivos han sido desactivados autom√°ticamente.`):v(d.deviceName):s(d.deviceName),b("toggle-device",{device:d,isActive:r})}catch(T){console.error("Error al cambiar estado del dispositivo:",T)}},X=d=>{b("edit-device",d)},Y=d=>{k.value=d,f.value=!0},Z=()=>{k.value&&b("delete-device",k.value),f.value=!1,k.value=null},ee=()=>{f.value=!1,k.value=null},te=d=>{x.value[d]=!x.value[d]},oe=async(d,r)=>{try{await navigator.clipboard.writeText(d),o.value[r]=!0,i();try{await(await L(async()=>{const{default:l}=await import("./Dxmh1sec.js");return{default:l}},__vite__mapDeps([0,1,2]),import.meta.url)).default.createApiKeyCopiedAlert()}catch(T){console.warn("No se pudo crear la alerta de API key copiada:",T)}setTimeout(()=>{o.value[r]=!1},2e3)}catch(T){console.error("Error al copiar AppKey:",T);const l=document.createElement("textarea");l.value=d,document.body.appendChild(l),l.select();try{o.value[r]=!0,i();try{await(await L(async()=>{const{default:_}=await import("./Dxmh1sec.js");return{default:_}},__vite__mapDeps([0,1,2]),import.meta.url)).default.createApiKeyCopiedAlert()}catch(u){console.warn("No se pudo crear la alerta de API key copiada (fallback):",u)}setTimeout(()=>{o.value[r]=!1},2e3)}catch(u){console.error("Error en fallback de copiado:",u),N()}document.body.removeChild(l)}},se=d=>{t.value[d]=!t.value[d]},re=async(d,r)=>{try{await navigator.clipboard.writeText(d),c.value[r]=!0,i(),setTimeout(()=>{c.value[r]=!1},2e3)}catch(T){console.error("Error al copiar TTN Access Key:",T);const l=document.createElement("textarea");l.value=d,document.body.appendChild(l),l.select();try{c.value[r]=!0,i(),setTimeout(()=>{c.value[r]=!1},2e3)}catch(u){console.error("Error en fallback de copiado:",u),N()}document.body.removeChild(l)}},ie=()=>{const d=document.querySelector("[data-device-form]")||document.querySelector(".device-form")||document.querySelector("form");d?d.scrollIntoView({behavior:"smooth",block:"start"}):window.scrollTo({top:0,behavior:"smooth"})};return(d,r)=>{var T;return n(),a("div",null,[K(Be,{"device-store":y.deviceStore,onFilterChange:A},null,8,["device-store"]),K(W,{title:"Dispositivos Registrados"},{"header-actions":j(()=>[e("div",je,[e("div",Ve,[e("span",ze,"Total: "+I(y.deviceStore.deviceCount),1)]),r[0]||(r[0]=e("div",{class:"text-xs text-gray-500 bg-gray-800 px-2 py-1 rounded"},[e("svg",{class:"w-3 h-3 inline mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})]),M(" Activaci√≥n autom√°tica: al activar un dispositivo se desactivan los dem√°s ")],-1))])]),default:j(()=>[h.value.length===0?(n(),a("div",Re,[r[2]||(r[2]=e("svg",{class:"mx-auto h-12 w-12 text-gray-500 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})],-1)),e("h3",Fe,I(y.deviceStore.deviceCount===0?"No tienes dispositivos registrados":"No se encontraron dispositivos"),1),e("p",Ue,I(y.deviceStore.deviceCount===0?"Registra tu primer dispositivo para comenzar a usar el sistema de riego":"Intenta ajustar los filtros de b√∫squeda"),1),y.deviceStore.deviceCount===0?(n(),a("div",Le,[e("button",{onClick:ie,class:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-medium rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900"},r[1]||(r[1]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),M(" Registrar Primer Dispositivo ")]))])):S("",!0)])):(n(),a("div",qe,[e("table",Oe,[r[14]||(r[14]=e("thead",{class:"text-xs text-gray-300 uppercase bg-gray-800/50 border-b border-gray-600"},[e("tr",null,[e("th",{scope:"col",class:"px-4 py-4 font-medium text-center w-48"},"Device Name"),e("th",{scope:"col",class:"px-4 py-4 font-medium text-center w-40"},"EnddeviceID"),e("th",{scope:"col",class:"px-4 py-4 font-medium text-center w-32"},"AppEUI"),e("th",{scope:"col",class:"px-4 py-4 font-medium text-center w-32"},"DevEUI"),e("th",{scope:"col",class:"px-4 py-4 font-medium text-center w-48"},"AppKey"),e("th",{scope:"col",class:"px-4 py-4 font-medium text-center w-24"},"TTN Region"),e("th",{scope:"col",class:"px-4 py-4 font-medium text-center w-32"},"TTN App ID"),e("th",{scope:"col",class:"px-4 py-4 font-medium text-center w-48"},"TTN Access Key"),e("th",{scope:"col",class:"px-4 py-4 font-medium text-center w-32"},"Estado"),e("th",{scope:"col",class:"px-4 py-4 font-medium text-center w-32"},"Acciones")])],-1)),e("tbody",He,[(n(!0),a(R,null,F(h.value,(l,u)=>(n(),a("tr",{key:l.id||u,class:"hover:bg-gray-800/30 transition-colors duration-150"},[e("td",Pe,[e("div",Ge,[e("div",{class:$(["flex-shrink-0 w-3 h-3 rounded-full mr-3",l.isActive?"bg-green-500":"bg-gray-500"])},null,2),M(" "+I(l.deviceName),1)])]),e("td",Je,I(l.enddeviceId),1),e("td",Qe,[e("span",We,I(g(l.appEui)),1)]),e("td",Xe,[e("span",Ye,I(g(l.devEui)),1)]),e("td",Ze,[e("div",et,[e("div",tt,[e("input",{type:x.value[u]?"text":"password",value:l.appKey,readonly:"",class:"w-full px-2 py-1 bg-transparent text-gray-300 text-xs font-mono border-none outline-none cursor-text",placeholder:x.value[u]?"":"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",style:{"padding-right":"20px"}},null,8,ot)]),e("div",st,[e("button",{onClick:_=>te(u),class:"p-1 rounded hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",title:x.value[u]?"Ocultar AppKey":"Mostrar AppKey"},[x.value[u]?(n(),a("svg",it,r[3]||(r[3]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"},null,-1)]))):(n(),a("svg",lt,r[4]||(r[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])))],8,rt),e("button",{onClick:_=>oe(l.appKey,u),class:$(["p-1 rounded hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",{"text-green-500":o.value[u],"text-gray-400":!o.value[u]}]),title:`Copiar AppKey${o.value[u]?" - ¬°Copiado!":""}`},[o.value[u]?(n(),a("svg",at,r[5]||(r[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):(n(),a("svg",dt,r[6]||(r[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])))],10,nt)])])]),e("td",ct,[l.ttnRegion?(n(),a("span",ut,I(l.ttnRegion),1)):(n(),a("span",pt,"No configurado"))]),e("td",vt,[l.ttnAppId?(n(),a("div",mt,I(l.ttnAppId),1)):(n(),a("span",gt,"No configurado"))]),e("td",ft,[l.ttnAccessKey?(n(),a("div",yt,[e("div",xt,[e("input",{type:t.value[u]?"text":"password",value:l.ttnAccessKey,readonly:"",class:"w-full px-2 py-1 bg-transparent text-gray-300 text-xs font-mono border-none outline-none cursor-text",placeholder:t.value[u]?"":"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢",style:{"padding-right":"20px"}},null,8,bt)]),e("div",ht,[e("button",{onClick:_=>se(u),class:"p-1 rounded hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",title:t.value[u]?"Ocultar TTN Access Key":"Mostrar TTN Access Key"},[t.value[u]?(n(),a("svg",kt,r[7]||(r[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"},null,-1)]))):(n(),a("svg",At,r[8]||(r[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])))],8,wt),e("button",{onClick:_=>re(l.ttnAccessKey,u),class:$(["p-1 rounded hover:bg-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",{"text-green-500":c.value[u],"text-gray-400":!c.value[u]}]),title:`Copiar TTN Access Key${c.value[u]?" - ¬°Copiado!":""}`},[c.value[u]?(n(),a("svg",Ct,r[9]||(r[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):(n(),a("svg",Nt,r[10]||(r[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"},null,-1)])))],10,Et)])])):(n(),a("span",Tt,"No configurado"))]),e("td",It,[e("div",Dt,[K(ce,{modelValue:l.isActive,"onUpdate:modelValue":_=>l.isActive=_,label:`Toggle device ${l.deviceName}`,onChange:_=>B(l,_)},null,8,["modelValue","onUpdate:modelValue","label","onChange"]),K(ke,{"is-active":l.isActive,"show-status-dot":!1},null,8,["is-active"])])]),e("td",_t,[e("div",Kt,[e("div",Mt,[e("button",{onClick:_=>X(l),class:"p-2 text-gray-400 hover:text-blue-400 hover:bg-blue-900/20 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",title:`Editar ${l.deviceName}`,"aria-label":"Editar dispositivo"},[K(de,{class:"w-5 h-5"})],8,$t),r[11]||(r[11]=e("span",{class:"text-xs text-gray-400"},"Editar",-1))]),e("div",St,[e("button",{onClick:_=>Y(l),class:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-900/20 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500",title:`Eliminar ${l.deviceName}`,"aria-label":"Eliminar dispositivo"},r[12]||(r[12]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Bt),r[13]||(r[13]=e("span",{class:"text-xs text-gray-400"},"Borrar",-1))])])])]))),128))])])]))]),_:1}),K(ue,{"is-open":f.value,title:"Eliminar Dispositivo",message:"¬øEst√°s seguro de que quieres eliminar este dispositivo? Esta acci√≥n eliminar√° permanentemente el dispositivo y todos sus datos asociados.","item-name":(T=k.value)==null?void 0:T.deviceName,"item-type":"dispositivo",onConfirm:Z,onCancel:ee},null,8,["is-open","item-name"])])}}},Vt=O(jt,[["__scopeId","data-v-3b3bf415"]]),zt={class:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto"},Rt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ft={class:"border-t border-gray-600 pt-6"},Ut={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Lt={class:"flex justify-end space-x-4 pt-6 border-t border-gray-600"},qt=["disabled"],Ot={key:0,class:"flex items-center"},Ht={key:1,class:"flex items-center"},Pt={__name:"DeviceEditModal",props:{isOpen:{type:Boolean,default:!1},device:{type:Object,default:null}},emits:["close","save"],setup(y,{emit:D}){const m=y,b=D,v=E(!1),s=P({deviceName:"",enddeviceId:"",appEui:"",devEui:"",appKey:"",ttnRegion:"",ttnAppId:"",ttnAccessKey:""});z(()=>m.device,o=>{o&&(s.deviceName=o.deviceName||"",s.enddeviceId=o.enddeviceId||"",s.appEui=o.appEui||"",s.devEui=o.devEui||"",s.appKey=o.appKey||"",s.ttnRegion=o.ttnRegion||"",s.ttnAppId=o.ttnAppId||"",s.ttnAccessKey=o.ttnAccessKey||"")},{immediate:!0});const i=()=>{b("close")},N=async()=>{var o;if((o=m.device)!=null&&o.id){v.value=!0;try{const t={device_name:s.deviceName,enddevice_id:s.enddeviceId,app_eui:s.appEui,dev_eui:s.devEui,app_key:s.appKey,ttn_region:s.ttnRegion,ttn_app_id:s.ttnAppId,ttn_access_key:s.ttnAccessKey};b("save",{deviceId:m.device.id,updateData:t}),i()}catch(t){console.error("Error preparando datos para actualizaci√≥n:",t)}finally{v.value=!1}}},x=o=>{o.key==="Escape"&&m.isOpen&&i()};return z(()=>m.isOpen,o=>{o?(document.addEventListener("keydown",x),document.body.style.overflow="hidden"):(document.removeEventListener("keydown",x),document.body.style.overflow="")}),(o,t)=>y.isOpen?(n(),a("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:V(i,["self"])},[e("div",zt,[e("div",{class:"flex justify-between items-center mb-6"},[t[9]||(t[9]=e("h2",{class:"text-2xl font-bold text-white"},"Editar Dispositivo",-1)),e("button",{onClick:i,class:"text-gray-400 hover:text-white transition-colors"},t[8]||(t[8]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("form",{onSubmit:V(N,["prevent"]),class:"space-y-6"},[e("div",Rt,[e("div",null,[t[10]||(t[10]=e("label",{for:"edit-deviceName",class:"block text-sm font-medium text-white mb-2"}," Device Name * ",-1)),w(e("input",{id:"edit-deviceName","onUpdate:modelValue":t[0]||(t[0]=c=>s.deviceName=c),type:"text",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Ej: Sensor Riego 01"},null,512),[[C,s.deviceName]])]),e("div",null,[t[11]||(t[11]=e("label",{for:"edit-enddeviceId",class:"block text-sm font-medium text-white mb-2"}," EnddeviceID * ",-1)),w(e("input",{id:"edit-enddeviceId","onUpdate:modelValue":t[1]||(t[1]=c=>s.enddeviceId=c),type:"text",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Ej: my-device-01"},null,512),[[C,s.enddeviceId]])]),e("div",null,[t[12]||(t[12]=e("label",{for:"edit-appEui",class:"block text-sm font-medium text-white mb-2"}," AppEUI * ",-1)),w(e("input",{id:"edit-appEui","onUpdate:modelValue":t[2]||(t[2]=c=>s.appEui=c),type:"text",required:"",pattern:"[A-Fa-f0-9]{16}",maxlength:"16",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors font-mono",placeholder:"0123456789ABCDEF"},null,512),[[C,s.appEui]]),t[13]||(t[13]=e("p",{class:"mt-1 text-xs text-gray-400"},"16 caracteres hexadecimales",-1))]),e("div",null,[t[14]||(t[14]=e("label",{for:"edit-devEui",class:"block text-sm font-medium text-white mb-2"}," DevEUI * ",-1)),w(e("input",{id:"edit-devEui","onUpdate:modelValue":t[3]||(t[3]=c=>s.devEui=c),type:"text",required:"",pattern:"[A-Fa-f0-9]{16}",maxlength:"16",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors font-mono",placeholder:"FEDCBA9876543210"},null,512),[[C,s.devEui]]),t[15]||(t[15]=e("p",{class:"mt-1 text-xs text-gray-400"},"16 caracteres hexadecimales",-1))])]),e("div",null,[t[16]||(t[16]=e("label",{for:"edit-appKey",class:"block text-sm font-medium text-white mb-2"}," AppKey * ",-1)),w(e("input",{id:"edit-appKey","onUpdate:modelValue":t[4]||(t[4]=c=>s.appKey=c),type:"text",required:"",pattern:"[A-Fa-f0-9]{32}",maxlength:"32",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors font-mono",placeholder:"0123456789ABCDEF0123456789ABCDEF"},null,512),[[C,s.appKey]]),t[17]||(t[17]=e("p",{class:"mt-1 text-xs text-gray-400"},"32 caracteres hexadecimales",-1))]),e("div",Ft,[t[25]||(t[25]=e("h3",{class:"text-lg font-medium text-white mb-4 flex items-center"},[e("svg",{class:"w-5 h-5 mr-2 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"})]),M(" Configuraci√≥n TTN (The Things Network) ")],-1)),e("div",Ut,[e("div",null,[t[19]||(t[19]=e("label",{for:"edit-ttnRegion",class:"block text-sm font-medium text-white mb-2"}," TTN Region ",-1)),w(e("select",{id:"edit-ttnRegion","onUpdate:modelValue":t[5]||(t[5]=c=>s.ttnRegion=c),class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"},t[18]||(t[18]=[q('<option value="">Seleccionar regi√≥n</option><option value="eu1">Europe 1 (eu1)</option><option value="nam1">North America 1 (nam1)</option><option value="au1">Australia 1 (au1)</option><option value="as1">Asia 1 (as1)</option>',5)]),512),[[G,s.ttnRegion]]),t[20]||(t[20]=e("p",{class:"mt-1 text-xs text-gray-400"},"Regi√≥n del servidor TTN",-1))]),e("div",null,[t[21]||(t[21]=e("label",{for:"edit-ttnAppId",class:"block text-sm font-medium text-white mb-2"}," TTN Application ID ",-1)),w(e("input",{id:"edit-ttnAppId","onUpdate:modelValue":t[6]||(t[6]=c=>s.ttnAppId=c),type:"text",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"my-ttn-application"},null,512),[[C,s.ttnAppId]]),t[22]||(t[22]=e("p",{class:"mt-1 text-xs text-gray-400"},"ID de la aplicaci√≥n en TTN",-1))]),e("div",null,[t[23]||(t[23]=e("label",{for:"edit-ttnAccessKey",class:"block text-sm font-medium text-white mb-2"}," TTN Access Key ",-1)),w(e("input",{id:"edit-ttnAccessKey","onUpdate:modelValue":t[7]||(t[7]=c=>s.ttnAccessKey=c),type:"password",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors font-mono",placeholder:"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"},null,512),[[C,s.ttnAccessKey]]),t[24]||(t[24]=e("p",{class:"mt-1 text-xs text-gray-400"},"Clave de acceso para la API TTN",-1))])]),t[26]||(t[26]=q('<div class="mt-4 p-3 bg-blue-900/20 border border-blue-500/30 rounded-lg"><div class="flex items-start"><svg class="w-5 h-5 text-blue-400 mt-0.5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class="text-sm text-blue-300"><p class="font-medium mb-1">Configuraci√≥n TTN (Opcional)</p><p>Los campos TTN son necesarios para el control remoto de la bomba de riego. Puedes configurarlos ahora o m√°s tarde.</p></div></div></div>',1))]),e("div",Lt,[e("button",{type:"button",onClick:i,class:"px-6 py-3 text-gray-300 hover:text-white border border-gray-600 rounded-lg hover:bg-gray-700 transition-colors"}," Cancelar "),e("button",{type:"submit",disabled:v.value,class:"px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white rounded-lg transition-colors flex items-center"},[v.value?(n(),a("span",Ot,t[27]||(t[27]=[e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),M(" Guardando... ")]))):(n(),a("span",Ht,t[28]||(t[28]=[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),M(" Guardar Cambios ")])))],8,qt)])],32)])])):S("",!0)}},Gt={class:"space-y-8"},oo={__name:"dispositivos",setup(y){const D=H(),m=Q(),{toast:b}=U(),v=E(!1),s=E(null);ne(async()=>{var p;if((p=D.user)!=null&&p.id)try{await m.fetchUserDevice(D.user.id)}catch(f){console.error("Error cargando dispositivo:",f),b.error("Error al cargar dispositivo")}});const i=async p=>{var f;try{const k={device_name:p.deviceName,enddevice_id:p.enddeviceId,app_eui:p.appEui,dev_eui:p.devEui,app_key:p.appKey,is_active_communication:!1,ttn_region:p.ttnRegion||null,ttn_app_id:p.ttnAppId||null,ttn_access_key:p.ttnAccessKey||null};console.log("üìù Datos a enviar:",k);const h=await m.createDevice(k);console.log("‚úÖ Dispositivo creado exitosamente:",(f=h.data)==null?void 0:f.device_name),b.success("Dispositivo registrado exitosamente")}catch(k){console.error("‚ùå Error creando dispositivo:",k),b.error(k.message||"Error al registrar dispositivo")}},N=async({device:p,isActive:f})=>{console.log(`Evento de toggle recibido para ${p.deviceName}: ${f?"activado":"desactivado"}`)},x=p=>{console.log("üîß Editar dispositivo:",p.deviceName),s.value=p,v.value=!0},o=()=>{v.value=!1,s.value=null},t=async({deviceId:p,updateData:f})=>{try{await m.updateDevice(p,f),console.log("‚úÖ Dispositivo actualizado exitosamente"),b.success("Dispositivo actualizado exitosamente")}catch(k){console.error("‚ùå Error actualizando dispositivo:",k),b.error(k.message||"Error al actualizar dispositivo")}},c=async p=>{try{await m.deleteDevice(p.id),console.log("‚úÖ Dispositivo eliminado exitosamente"),b.success("Dispositivo eliminado exitosamente")}catch(f){console.error("‚ùå Error eliminando dispositivo:",f),b.error(f.message||"Error al eliminar dispositivo")}};return(p,f)=>(n(),a("div",Gt,[f[0]||(f[0]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-white"},"Dispositivos IoT"),e("p",{class:"text-gray-400 mt-2"},"Gesti√≥n y monitoreo de dispositivos para el sistema de riego autom√°tico")],-1)),K(he,{onDeviceAdded:i}),K(Vt,{"device-store":ae(m),onToggleDevice:N,onEditDevice:x,onDeleteDevice:c},null,8,["device-store"]),K(Pt,{"is-open":v.value,device:s.value,onClose:o,onSave:t},null,8,["is-open","device"])]))}};export{oo as default};
