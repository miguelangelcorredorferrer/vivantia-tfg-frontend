import{_ as S}from"./YHwIe9Gn.js";import{N as E,G as M,u as j,r as u,q as B,c as n,o as l,j as x,a as o,h as y,i as b,v as k,m as h,t as C,d as _,H as L,b as R,w as G}from"./Z3C1zjOC.js";import{u as H}from"./DPZQ8nY_.js";const U={key:0,class:"text-center py-8"},A={key:1},D={key:0,class:"text-red-500 text-sm mt-1"},I={key:0,class:"text-red-500 text-sm mt-1"},P=["disabled"],$={key:0},q={key:1,class:"flex items-center justify-center"},F={key:2,class:"text-center py-8"},W={__name:"[token]",setup(O){const N=E(),V=M(),m=j(),{toast:p}=H(),{token:f}=N.params,v=u(!1),g=u(!0),i=u(""),d=u(""),s=u({}),c=u(!1);B(async()=>{var t,e;try{await m.verifyPasswordResetToken(f),v.value=!0}catch(r){console.error("Error verificando token:",r);const a=((e=(t=r.response)==null?void 0:t.data)==null?void 0:e.msg)||"Token inválido o expirado";p.error(a),v.value=!1}finally{g.value=!1}});const z=()=>(s.value={},i.value?i.value.length<8&&(s.value.password="La contraseña debe tener al menos 8 caracteres"):s.value.password="La contraseña es obligatoria",d.value?i.value!==d.value&&(s.value.passwordConfirm="Las contraseñas no coinciden"):s.value.passwordConfirm="Confirmar contraseña es obligatorio",Object.keys(s.value).length===0),T=async()=>{var t,e;if(z())try{c.value=!0;const r=await m.updatePassword(f,i.value);p.success(r.msg||"Contraseña actualizada exitosamente"),setTimeout(()=>{V.push("/auth/login")},2e3)}catch(r){console.error("Error actualizando contraseña:",r);const a=((e=(t=r.response)==null?void 0:t.data)==null?void 0:e.msg)||"Error al actualizar la contraseña";p.error(a)}finally{c.value=!1}},w=t=>{s.value[t]&&delete s.value[t]};return(t,e)=>{const r=S;return l(),n("div",null,[g.value?(l(),n("div",U,e[4]||(e[4]=[x('<div class="flex justify-center mb-4"><svg class="animate-spin h-8 w-8 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg></div><p class="text-gray-600">Verificando token...</p>',2)]))):v.value?(l(),n("div",A,[e[8]||(e[8]=o("div",{class:"text-center mb-6"},[o("h2",{class:"text-2xl font-bold text-gray-800 mb-2"},"Nueva Contraseña"),o("p",{class:"text-gray-600"},"Establece una nueva contraseña para tu cuenta")],-1)),o("form",{onSubmit:L(T,["prevent"]),class:"space-y-4"},[o("div",null,[e[5]||(e[5]=o("label",{for:"password",class:"block text-sm font-medium text-gray-700 mb-1"}," Nueva contraseña ",-1)),y(o("input",{id:"password","onUpdate:modelValue":e[0]||(e[0]=a=>i.value=a),type:"password",placeholder:"Mínimo 8 caracteres",class:h(["w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",{"border-red-500":s.value.password}]),onInput:e[1]||(e[1]=a=>w("password"))},null,34),[[k,i.value]]),s.value.password?(l(),n("p",D,C(s.value.password),1)):b("",!0)]),o("div",null,[e[6]||(e[6]=o("label",{for:"passwordConfirm",class:"block text-sm font-medium text-gray-700 mb-1"}," Confirmar nueva contraseña ",-1)),y(o("input",{id:"passwordConfirm","onUpdate:modelValue":e[2]||(e[2]=a=>d.value=a),type:"password",placeholder:"Repite tu nueva contraseña",class:h(["w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",{"border-red-500":s.value.passwordConfirm}]),onInput:e[3]||(e[3]=a=>w("passwordConfirm"))},null,34),[[k,d.value]]),s.value.passwordConfirm?(l(),n("p",I,C(s.value.passwordConfirm),1)):b("",!0)]),o("button",{type:"submit",disabled:c.value,class:"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed"},[c.value?(l(),n("span",q,e[7]||(e[7]=[o("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),_(" Guardando... ")]))):(l(),n("span",$,"Guardar nueva contraseña"))],8,P)],32)])):(l(),n("div",F,[e[10]||(e[10]=x('<div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"><svg class="w-8 h-8 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div><h3 class="text-lg font-semibold text-gray-800 mb-2">Token inválido</h3><p class="text-gray-600 mb-6"> El enlace de recuperación ha expirado o no es válido. </p>',3)),R(r,{to:"/auth/forgot-password",class:"inline-block bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors duration-200"},{default:G(()=>e[9]||(e[9]=[_(" Solicitar nuevo enlace ")])),_:1,__:[9]})]))])}}};export{W as default};
