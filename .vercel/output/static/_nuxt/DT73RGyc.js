import{_ as N}from"./YHwIe9Gn.js";import{c as l,o as a,a as e,t as c,A as y,w as S,d as i,F as k,x as I,G as O,u as G,r as x,g as R,p as U,q as J,b as h,H,i as W,h as u,v as g,s as K,m as Q,B as _,k as w}from"./Z3C1zjOC.js";import{u as X}from"./DPZQ8nY_.js";import{u as Y}from"./6yrW6Ic0.js";import{g as C}from"./DYYJ9xn1.js";import{B}from"./B0aUQyeA.js";import"./DTkYgPEM.js";const Z={class:"text-3xl font-bold text-white"},ee={class:"text-gray-400 text-lg"},te={__name:"CropPageTitle",props:{title:{type:String,required:!0},description:{type:String,required:!0}},setup(p){return(V,d)=>(a(),l("div",null,[e("h1",Z,c(p.title),1),e("p",ee,c(p.description),1)]))}},re={class:"space-y-4"},se={class:"border-t border-gray-600 pt-4"},oe={class:"space-y-1"},ae={class:"border-t border-gray-600 pt-4"},ie={class:"space-y-1"},le={__name:"CropInfoSidebar",props:{availableCategories:{type:Array,default:()=>[]},availableSeasons:{type:Array,default:()=>[]}},setup(p){return(V,d)=>(a(),y(B,{title:"Informaci√≥n de Ayuda"},{default:S(()=>[e("div",re,[d[2]||(d[2]=e("div",null,[e("h4",{class:"text-sm font-medium text-white mb-3"},"Consejos para el Formulario"),e("div",{class:"space-y-3"},[e("div",{class:"bg-blue-900/20 border border-blue-500/30 rounded-lg p-3"},[e("p",{class:"text-xs text-blue-300"},[e("strong",null,"Humedad:"),i(" Tenga en cuenta que hay 2 tipos de humedad, la humedad del suelo y la humedad del aire o ambiental. ")])]),e("div",{class:"bg-green-900/20 border border-green-500/30 rounded-lg p-3"},[e("p",{class:"text-xs text-green-300"},[e("strong",null,"Temperatura:"),i(" Indica la temperatura m√°xima que puede tolerar el cultivo. ")])]),e("div",{class:"bg-purple-900/20 border border-purple-500/30 rounded-lg p-3"},[e("p",{class:"text-xs text-purple-300"},[e("strong",null,"Imagen:"),i(" Usa una foto clara y representativa del cultivo para mejor identificaci√≥n. ")])])])],-1)),e("div",se,[d[0]||(d[0]=e("h4",{class:"text-sm font-medium text-white mb-3"},"Categor√≠as actualmente registradas en el sistema",-1)),e("div",oe,[(a(!0),l(k,null,I(p.availableCategories,n=>(a(),l("div",{key:n,class:"text-xs text-gray-400"}," ‚Ä¢ "+c(n),1))),128))])]),e("div",ae,[d[1]||(d[1]=e("h4",{class:"text-sm font-medium text-white mb-3"},"Temporadas",-1)),e("div",ie,[(a(!0),l(k,null,I(p.availableSeasons,n=>(a(),l("div",{key:n,class:"text-xs text-gray-400"}," ‚Ä¢ "+c(n),1))),128))])])])]),_:1}))}},ne={class:"space-y-8"},de={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ue={class:"lg:col-span-2"},me={class:"space-y-4"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pe={class:"space-y-4"},ce={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},xe={class:"space-y-4"},ye={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},be=["value"],fe={class:"space-y-4"},ve={class:"mt-2"},he={key:0,class:"w-full h-full relative"},_e=["src"],we={key:0,class:"bg-red-900/20 border border-red-500/30 rounded-lg p-4"},Ce={class:"flex items-start"},ke={class:"mt-1 text-sm text-red-300 list-disc list-inside"},Ie={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-3 sm:space-y-0 pt-6 border-t border-gray-600"},Ve={class:"flex items-center space-x-2"},De={class:"flex space-x-3"},He=["disabled"],Se={key:0,class:"flex items-center"},qe={key:1,class:"flex items-center"},Me={class:"lg:col-span-1"},je={__name:"index",setup(p){const V=O(),{toast:d}=X(),n=Y(),F=G(),b=x(!1),q=x(!1),f=x(""),M=x(null),D=x(null),r=R({name:"",description:"",category:"",soil_humidity_min:null,soil_humidity_max:null,air_humidity_min:null,air_humidity_max:null,temperature_max:null,growth_days:null,session:"",image:null}),$=U(()=>n.categories.length>0?n.categories:["Hortalizas","Frutas","Hierbas","Cereales","Legumbres"]),A=["Primavera","Verano","Oto√±o","Invierno","Primavera/Verano","Verano/Oto√±o","Oto√±o/Invierno","Invierno/Primavera","Todo el a√±o"],v=U(()=>{const s=[];return r.soil_humidity_min&&r.soil_humidity_max&&r.soil_humidity_min>=r.soil_humidity_max&&s.push("La humedad del suelo m√≠nima debe ser menor que la m√°xima"),r.soil_humidity_min&&(r.soil_humidity_min<0||r.soil_humidity_min>100)&&s.push("La humedad del suelo m√≠nima debe estar entre 0 y 100%"),r.soil_humidity_max&&(r.soil_humidity_max<0||r.soil_humidity_max>100)&&s.push("La humedad del suelo m√°xima debe estar entre 0 y 100%"),r.air_humidity_min&&r.air_humidity_max&&r.air_humidity_min>=r.air_humidity_max&&s.push("La humedad del aire m√≠nima debe ser menor que la m√°xima"),r.air_humidity_min&&(r.air_humidity_min<0||r.air_humidity_min>100)&&s.push("La humedad del aire m√≠nima debe estar entre 0 y 100%"),r.air_humidity_max&&(r.air_humidity_max<0||r.air_humidity_max>100)&&s.push("La humedad del aire m√°xima debe estar entre 0 y 100%"),r.temperature_max&&(r.temperature_max<0||r.temperature_max>50)&&s.push("La temperatura m√°xima debe estar entre 0 y 50¬∞C"),r.growth_days&&(r.growth_days<1||r.growth_days>365)&&s.push("Los d√≠as de crecimiento deben estar entre 1 y 365"),s}),j=s=>{const t=s.target.files[0];t&&T(t)},E=s=>{s.preventDefault(),q.value=!1;const t=s.dataTransfer.files[0];t&&t.type.startsWith("image/")&&T(t)},T=s=>{if(s.size>10*1024*1024){alert("La imagen es demasiado grande. M√°ximo 10MB.");return}M.value=s,r.image=s;const t=new FileReader;t.onload=m=>{f.value=m.target.result},t.readAsDataURL(s)},L=()=>{f.value="",M.value=null,r.image=null,D.value&&(D.value.value="")},P=()=>{Object.keys(r).forEach(s=>{typeof r[s]=="string"?r[s]="":r[s]=null}),L()},z=async()=>{var s,t;if(!(v.value.length>0)){b.value=!0;try{const m={user_id:F.user.id,name:r.name,description:r.description,category:r.category,growth_days:r.growth_days,soil_humidity_min:r.soil_humidity_min,soil_humidity_max:r.soil_humidity_max,air_humidity_min:r.air_humidity_min,air_humidity_max:r.air_humidity_max,temperature_max:r.temperature_max,session:r.session,image:r.image||null,selected:!1};console.log("üîç Frontend - Datos a enviar:",m);const o=await n.createCrop(m);d.success(`¬°Cultivo "${o.data.name}" agregado exitosamente!`),n.categories.includes(r.category)||await n.fetchCropCategories(),setTimeout(()=>{V.push("/cultivos")},1500)}catch(m){console.error("Error al agregar cultivo:",m),d.error(((t=(s=m.response)==null?void 0:s.data)==null?void 0:t.message)||"Error al agregar el cultivo")}finally{b.value=!1}}};return J(async()=>{try{n.isInitialized||await n.fetchCropCategories()}catch(s){console.error("Error cargando categor√≠as:",s)}}),(s,t)=>{const m=N;return a(),l("div",ne,[h(te,{title:"Agregar Cultivo",description:"Configura un nuevo cultivo para el sistema de riego automatizado"}),e("div",de,[e("div",ue,[h(B,{title:"Informaci√≥n del Cultivo"},{default:S(()=>[e("form",{onSubmit:H(z,["prevent"]),class:"space-y-6"},[e("div",me,[t[16]||(t[16]=e("h3",{class:"text-lg font-medium text-white border-b border-gray-600 pb-2"}," Informaci√≥n B√°sica ",-1)),e("div",ge,[e("div",null,[t[13]||(t[13]=e("label",{for:"name",class:"block text-sm font-medium text-white mb-2"},[i(" Nombre del Cultivo "),e("span",{class:"text-red-400"},"*")],-1)),u(e("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=o=>r.name=o),type:"text",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",placeholder:"Ej: Tomate Cherry"},null,512),[[g,r.name]])]),e("div",null,[t[14]||(t[14]=e("label",{for:"category",class:"block text-sm font-medium text-white mb-2"},[i(" Categor√≠a "),e("span",{class:"text-red-400"},"*")],-1)),u(e("input",{id:"category","onUpdate:modelValue":t[1]||(t[1]=o=>r.category=o),type:"text",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",placeholder:"Ej: Hortalizas, Frutas, Hierbas..."},null,512),[[g,r.category]])])]),e("div",null,[t[15]||(t[15]=e("label",{for:"description",class:"block text-sm font-medium text-white mb-2"},[i(" Descripci√≥n "),e("span",{class:"text-red-400"},"*")],-1)),u(e("textarea",{id:"description","onUpdate:modelValue":t[2]||(t[2]=o=>r.description=o),rows:"3",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors resize-none",placeholder:"Descripci√≥n detallada del cultivo..."},null,512),[[g,r.description]])])]),e("div",pe,[t[27]||(t[27]=e("h3",{class:"text-lg font-medium text-white border-b border-gray-600 pb-2"}," Par√°metros de Cultivo ",-1)),e("div",ce,[e("div",null,[t[17]||(t[17]=e("label",{for:"minHumidity",class:"block text-sm font-medium text-white mb-2"},[i(" Humedad M√≠nima (%) "),e("span",{class:"text-red-400"},"*")],-1)),u(e("input",{id:"minHumidity","onUpdate:modelValue":t[3]||(t[3]=o=>r.soil_humidity_min=o),type:"number",min:"0",max:"100",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",placeholder:"50"},null,512),[[g,r.soil_humidity_min,void 0,{number:!0}]]),t[18]||(t[18]=e("p",{class:"mt-1 text-xs text-gray-400"},"Valor m√≠nimo recomendado",-1))]),e("div",null,[t[19]||(t[19]=e("label",{for:"maxHumidity",class:"block text-sm font-medium text-white mb-2"},[i(" Humedad M√°xima (%) "),e("span",{class:"text-red-400"},"*")],-1)),u(e("input",{id:"maxHumidity","onUpdate:modelValue":t[4]||(t[4]=o=>r.soil_humidity_max=o),type:"number",min:"0",max:"100",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",placeholder:"80"},null,512),[[g,r.soil_humidity_max,void 0,{number:!0}]]),t[20]||(t[20]=e("p",{class:"mt-1 text-xs text-gray-400"},"Valor m√°ximo recomendado",-1))]),e("div",null,[t[21]||(t[21]=e("label",{for:"minAirHum",class:"block text-sm font-medium text-white mb-2"},[i(" Humedad Aire Min (%) "),e("span",{class:"text-red-400"},"*")],-1)),u(e("input",{id:"minAirHum","onUpdate:modelValue":t[5]||(t[5]=o=>r.air_humidity_min=o),type:"number",min:"0",max:"100",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",placeholder:"50"},null,512),[[g,r.air_humidity_min,void 0,{number:!0}]]),t[22]||(t[22]=e("p",{class:"mt-1 text-xs text-gray-400"},"M√≠nimo humedad ambiental",-1))]),e("div",null,[t[23]||(t[23]=e("label",{for:"maxAirHum",class:"block text-sm font-medium text-white mb-2"},[i(" Humedad Aire M√°x (%) "),e("span",{class:"text-red-400"},"*")],-1)),u(e("input",{id:"maxAirHum","onUpdate:modelValue":t[6]||(t[6]=o=>r.air_humidity_max=o),type:"number",min:"0",max:"100",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",placeholder:"85"},null,512),[[g,r.air_humidity_max,void 0,{number:!0}]]),t[24]||(t[24]=e("p",{class:"mt-1 text-xs text-gray-400"},"M√°ximo humedad ambiental",-1))]),e("div",null,[t[25]||(t[25]=e("label",{for:"maxTemperature",class:"block text-sm font-medium text-white mb-2"},[i(" Temperatura M√°xima (¬∞C) "),e("span",{class:"text-red-400"},"*")],-1)),u(e("input",{id:"maxTemperature","onUpdate:modelValue":t[7]||(t[7]=o=>r.temperature_max=o),type:"number",min:"0",max:"50",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",placeholder:"30"},null,512),[[g,r.temperature_max,void 0,{number:!0}]]),t[26]||(t[26]=e("p",{class:"mt-1 text-xs text-gray-400"},"Temperatura m√°xima tolerable",-1))])])]),e("div",xe,[t[32]||(t[32]=e("h3",{class:"text-lg font-medium text-white border-b border-gray-600 pb-2"}," Informaci√≥n Adicional ",-1)),e("div",ye,[e("div",null,[t[28]||(t[28]=e("label",{for:"growthDays",class:"block text-sm font-medium text-white mb-2"},[i(" D√≠as de Crecimiento "),e("span",{class:"text-red-400"},"*")],-1)),u(e("input",{id:"growthDays","onUpdate:modelValue":t[8]||(t[8]=o=>r.growth_days=o),type:"number",min:"1",max:"365",required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors",placeholder:"90"},null,512),[[g,r.growth_days,void 0,{number:!0}]]),t[29]||(t[29]=e("p",{class:"mt-1 text-xs text-gray-400"},"D√≠as desde siembra hasta cosecha",-1))]),e("div",null,[t[31]||(t[31]=e("label",{for:"session",class:"block text-sm font-medium text-white mb-2"},[i(" Temporada de Cosecha "),e("span",{class:"text-red-400"},"*")],-1)),u(e("select",{id:"session","onUpdate:modelValue":t[9]||(t[9]=o=>r.session=o),required:"",class:"w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors"},[t[30]||(t[30]=e("option",{value:""},"Selecciona una temporada",-1)),(a(),l(k,null,I(A,o=>e("option",{key:o,value:o},c(o),9,be)),64))],512),[[K,r.session]])])])]),e("div",fe,[t[36]||(t[36]=e("h3",{class:"text-lg font-medium text-white border-b border-gray-600 pb-2"}," Imagen del Cultivo ",-1)),e("div",null,[t[34]||(t[34]=e("label",{for:"image",class:"block text-sm font-medium text-white mb-2"}," Foto del Cultivo ",-1)),e("div",ve,[e("div",{onDrop:E,onDragover:t[11]||(t[11]=H(()=>{},["prevent"])),onDragenter:t[12]||(t[12]=H(()=>{},["prevent"])),class:Q(["w-full h-40 border-2 border-dashed border-gray-600 rounded-lg bg-gray-700 hover:bg-gray-600 transition-colors cursor-pointer group",{"border-green-500 bg-green-900/20":q.value}])},[e("input",{ref_key:"imageInput",ref:D,type:"file",accept:"image/*",onChange:j,class:"hidden"},null,544),f.value?(a(),l("div",he,[e("img",{src:f.value,alt:"Preview",class:"w-full h-full object-cover rounded-lg"},null,8,_e),e("button",{type:"button",onClick:L,class:"absolute top-2 right-2 bg-red-600 hover:bg-red-700 text-white rounded-full p-1 transition-colors"},[(a(),y(_(w(C)("close")),{class:"w-4 h-4"}))])])):(a(),l("div",{key:1,onClick:t[10]||(t[10]=o=>s.$refs.imageInput.click()),class:"flex flex-col items-center justify-center h-full"},t[33]||(t[33]=[e("svg",{class:"w-12 h-12 text-gray-400 group-hover:text-gray-300 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),e("p",{class:"mt-2 text-sm text-gray-400 group-hover:text-gray-300 transition-colors"},[e("span",{class:"font-medium"},"Haz clic para subir"),i(" o arrastra y suelta ")],-1),e("p",{class:"text-xs text-gray-500"},"PNG, JPG, GIF hasta 10MB",-1)])))],34)]),t[35]||(t[35]=e("p",{class:"mt-2 text-xs text-gray-400"}," Selecciona una imagen representativa del cultivo (opcional) ",-1))])]),v.value.length>0?(a(),l("div",we,[e("div",Ce,[(a(),y(_(w(C)("warning")),{class:"w-5 h-5 text-red-400 mt-0.5 mr-2 flex-shrink-0"})),e("div",null,[t[37]||(t[37]=e("p",{class:"text-sm font-medium text-red-400"},"Errores de validaci√≥n:",-1)),e("ul",ke,[(a(!0),l(k,null,I(v.value,o=>(a(),l("li",{key:o},c(o),1))),128))])])])])):W("",!0),e("div",Ie,[h(m,{to:"/cultivos",class:"px-6 py-3 text-gray-400 hover:text-white border border-gray-600 hover:border-gray-500 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500"},{default:S(()=>[e("div",Ve,[(a(),y(_(w(C)("back")),{class:"w-4 h-4"})),t[38]||(t[38]=e("span",null,"Volver",-1))])]),_:1}),e("div",De,[e("button",{type:"button",onClick:P,class:"px-6 py-3 text-yellow-400 hover:text-yellow-300 border border-yellow-500/30 hover:border-yellow-400/50 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-yellow-500"}," Limpiar Form "),e("button",{type:"submit",disabled:b.value||v.value.length>0,class:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg shadow-lg hover:from-green-600 hover:to-emerald-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105"},[b.value?(a(),l("span",Se,[(a(),y(_(w(C)("spinner")),{class:"animate-spin w-5 h-5 mr-2"})),t[39]||(t[39]=i(" Agregando... "))])):(a(),l("span",qe,t[40]||(t[40]=[e("svg",{class:"w-5 h-5 mr-2 text-white",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",viewBox:"0 0 24 24"},[e("path",{d:"M20 6L9 17l-5-5"})],-1),i(" Agregar Cultivo ")])))],8,He)])])],32)]),_:1})]),e("div",Me,[h(le,{"available-categories":$.value,"available-seasons":A},null,8,["available-categories"])])])])}}};export{je as default};
