import{af as i,X as n,u,f as t,ag as d}from"./Z3C1zjOC.js";import{u as l}from"./6yrW6Ic0.js";import{u as p}from"./DPZQ8nY_.js";import"./DTkYgPEM.js";const h=i(async(f,m)=>{let c,a;console.log("üîí Middleware crop-required ejecut√°ndose...");const{$pinia:s}=n(),r=u(s),e=l(s);try{if(!r.user||!r.user.id)return console.warn("‚ö†Ô∏è Usuario no autenticado en crop-required middleware"),t("/auth/login");if(!e.currentCrop){console.log("üîÑ Cargando cultivo seleccionado en middleware...");try{[c,a]=d(()=>e.fetchSelectedCrop(r.user.id)),await c,a()}catch{console.log("üìù No hay cultivo seleccionado para este usuario")}}if(!e.currentCrop||!e.currentCrop.id||!e.currentCrop.selected){console.warn("‚ö†Ô∏è No hay cultivo seleccionado, redirigiendo a cultivos");const{toast:o}=p();return o.warning("Debes seleccionar un cultivo antes de acceder a los modos de riego"),t("/cultivos")}console.log("‚úÖ Cultivo seleccionado verificado:",e.currentCrop.name)}catch(o){return console.error("‚ùå Error en middleware crop-required:",o),t("/cultivos")}});export{h as default};
